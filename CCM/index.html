<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Talk</title>

	<meta name="description" content="January 2025">
	<link rel="stylesheet" href="reveal.js/dist/reset.css">
	<link rel="stylesheet" href="reveal.js/dist/reveal.css">
	<link rel="stylesheet" href="reveal.js/dist/theme/darkenergy.css" id="theme">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="reveal.js/plugin/highlight/monokai.css" id="highlight-theme">
</head>

<!-- Colors
#B1CB11 - yellow-green
# 6e93d6 - blue
-->

<body>
	<div class="reveal">
		<div class="slides">
			<section data-background-image="assets/1-Perseus-cluster_1oEasJg.jpg">
			<!-- <section> -->
					<!-- </section> data-background-image="asseots/lsst_stills_0009_crop.jpg"> -->
			
				<div class="container">
					<div class="title" style="position:relative; left:200px; border-radius: 20px; background-color:rgba(0, 0, 0, .6);">
						<br>
						<h2> Generative Modeling for   <br> Astrophysical Inverse Problems
						<!-- <br> for inference with corrupted data -->
					</h2>
						<!-- <h2>Joint Bayesian inference of galaxy morphologies and cosmic shear</h2> -->
						<center><hr size="100" width="600"></center>
						<!-- <center><hr size="100" width="400"></center> -->
						<center><hr size="100" width="900", style="opacity:0%"></center>
						<!-- <br> -->
						<h2>Benjamin Remy</h2>
						<p>Postdoctoral Research Associate
						<br>
						Department Of Astrophysical Sciences, Princeton University</p>
						<p style="color:#6e93d6"><em>at the Computational Center for Mathematics, Flatiron Institute <br> January 6, 2025 </em>  </p>
					<br>
					<!-- <p>under the supervision of Jean-Luc Starck and François
						Lanusse</p> -->
					</div>
				</div>
			
				
				<!-- <hr> -->
				<!-- <div>
					<a href="https://arxiv.org/abs/2201.05561"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2201.05561-B31B1B.svg" class="plain" style="height:25px;" /></a>
					<a href="https://arxiv.org/abs/2011.08698"><img src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg" class="plain" style="height:25px;" /></a>
				</div> -->
				<!-- <div style="position:relative; left:0px; border-radius: 20px; background-color:rgba(0, 0, 0, .6)">
				<p>under the supervision of Jean-Luc Starck and François
				Lanusse</p>
			
				<p><small>CosmoStat, CEA Paris-Saclay, IRFU/DAp-AIM <br>
					Université Paris Saclay, ED Astronomie et Astrophysique d’Ile-de-France</small></p>
					
				</div> -->
				<!-- <br> -->
				 
				<div class="container" style="width: 1000px; position:relative; left:150px">
					<div class="col">
						<br>
					    <img src="assets/University_of_Princeton_Logo.png" class="plain" height="130"></img>
					</div>

					<div class="col">
						<br>
						<img src="assets/verarubinobs.png" class="plain" height="130"></img>
					</div>

				</div>
				<!-- <div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.6);">  -->
				<!-- <div class="container">
					<div style="position:relative; left:200px; width:900px; border-radius: 20px; background-color:rgba(0, 0, 0, 0.6);">
					slides at <a style="color:#6e93d6" href="https://b-remy.github.io/talks/Defense">b-remy.github.io/talks/Defense</a> 
				</div>
				</div> -->

	
			</section>
		

			<!-- <section>
				<h3 class="slide-title" style="position:relative;top:0;">
					Background
				</h3>
				<br>
				<br>				
				<div>
					M.S. at Université de Rennes & Diplome d'ingénieur
					<br>
					<b class="alert">Signal processing</b> and <b class="alert">statistics</b>
				</div>	
					<br>
					<br>
					<br>
				<div>
					Ph.D. in <b class="alert">Astrophysics</b> and <b class="alert">Machine learning</b> at Université Paris-Saclay and CEA Saclay
					<p style="color:#4789fa">Generative Modeling for Weak Lensing Inverse Problems</p>
					
					Under the supervision of Jean-Luc Starck and François Lanusse
				</div>	
				


				<br>
				<br>

				<div>
					Currently <b class="alert">Postdoctoral Research Associate</b> at the Department of Astrophysics, Princeton University</div>
			</section> -->

			<section>
				<section  data-background-image="assets/lsst_stills_0009_crop.jpg">
					<div class="container">
						<div class="title" style="position:relative; left:160px; border-radius: 20px; background-color:rgba(0,0, 0, 0.7);">
							
							<br>
							<h2> &nbsp Solving high dimensional inverse
							problems&nbsp &nbsp
							<br>
								with score-based generative models </h2>
							<!-- <h2>Joint Bayesian inference of galaxy morphologies and cosmic shear</h2> -->
							<center><hr size="100" width="600"></center>
							<center><hr size="100" width="400"></center>
							<center><hr size="100" width="900", style="opacity:0%"></center>
							<!-- <br> -->
							<small>
							<b class="alert"><u>B. Remy</u>, Z. Ramzi, F. Lanusse, J. Liu, J.-L.
								Starck
							
								<br>
								<em>Probabilistic Mapping of Dark Matter
								with Neural Score Matching, </em>
								<br> 3rd Machine Learning and the Physical Science workshop at
								NeurIPS, 2020.
							</b>
								<br>
								<a href="https://arxiv.org/abs/2011.08271"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2011.08271-B31B1B.svg" class="plain" style="height:25px;" /></a>
					
						<br>

						<b class="alert">Z. Ramzi, <u>B. Remy</u>, F. Lanusse, J.-L. Starck, P. Ciuciu </font>
						<br>
						<em>Denoising Score-Matching for
						Uncertainty Quantification in Inverse Problems,</em>
						<br>
						Deep inverse workshop at NeurIPS, 2020.
						</b>
						<br>
							<a href="https://arxiv.org/abs/2011.08698" style='vertical-align:middle; display:inline;'><img
							src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg" class="plain" style="height:25px;" /></a>
								
							<p style="color:#B1CB11">
								<u>B. Remy</u>, F. Lanusse, N. Jeffrey, J. Liu, J.-L.
								Starck, K. Ostato, T. Schrabback <br>
								<em>Probabilistic Mass-Mapping with Neural Score
								Estimation</em>
								<br>
								Astronomy & Astrophysics, January 2022
							</p>
						
							<a href="https://arxiv.org/abs/2201.05561"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2201.05561-B31B1B.svg" class="plain" style="height:25px;" /></a> 
						<br>
					</small>
						</div>
					</div>
				
					
				<!-- <div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.6);">  -->
				
				</section>


					<section>
						<h3 class="slide-title">Quantifying uncertainties with
						<b class="alert">Bayesian modeling</b></h3>
						We observe $y$ and look for $x$ such that $\boxed{y =
						f^{}(x)}$ where $f$ is known
						<br><br>
						<div class="fragment">
						Potentially <b class="alert">multiple</b> solutions $\boxed{x = f^{-1}(y)}$ but $f$ <b class="alert">non-bijective</b>
					</div>
						<!-- $\mathbf{A}$ is known and encodes our physical understanding of the problem.
						<span class="fragment"><br>$\Longrightarrow$ When non-invertible or ill-conditioned, the inverse problem is ill-posed <b class="alert">with no unique solution $x$</b></span> -->
						<!-- <div class="container fragment fade-up">
							<div class="col">
								<img data-src="assets/pluto_smooth.png" class="plain"></img>
								Deconvolution
							</div>
							<div class="col">
								<img data-src="assets/pluto_missing.png" class="plain"></img>
								Inpainting
							</div>
							<div class="col">
								<img data-src="assets/plutoNoise.png" class="plain"></img>
								Denoising
							</div>
						</div> -->
						<br>
						<br>
						<span class="fragment">The Bayesian view of the problem:
						<br>
						$$ p(x | y) \propto p(y | x) \ p(x) $$
						</span>
						<ul>
							<li class="fragment fade-up">$p(y | x)$ is the data
							<b class="alert">likelihood</b>, which <b>contains the physics</b><br>
							</li>
							<br>
							<li class="fragment fade-up">$p(x)$ is the <b class="alert">prior</b> knowledge on the solution.</li>
						</ul>
						<br>
						<br>
	
						<div class="container">
							<div class="col">
								<div class="fragment fade-up">
									We can estimate for instance the <b class="alert">Maximum A Posteriori</b> solution:
									<!-- <br>
									<br>
									<br> -->
									<!-- $$\hat{x} = \arg\max\limits_x \ \log p(y \ | \ x) + \log p(x)$$
									$\hat x = \arg\max\limits_x \ - \frac{1}{2} \parallel y - f(x) \parallel_{\mathbf{\Sigma}}^2 + \log p(x)$ -->
								</div>
							</div>
							<div class="col">
								<div class="fragment fade-up">
									Or <b class="alert">estimate the full
									posterior $p(x|y)$</b> with 
									<br>
									<br>
									<ul>
										<li>Markov Chain Monte Carlo</li>
										<li>Variational Inference methods</li>
									</ul> 
								</div>
								<br>
								<span class="fragment">  
									<b class="alert">$\boxed{\log p(y|x)}$</b> ??
								</span>
								<span class="fragment">  
									<b class="alert">$\boxed{\log p(x)}$</b> ??
								</span>
							</div>
						</div>
					</section>	


					<section>
						<h3 class="slide-title">Linear inverse problems</h3>
	
						$\boxed{y = \mathbf{A}x + n}$
						<br>
						<br>
						$\mathbf{A}$ is known and encodes our physical understanding of the problem.
						<span class="fragment"><br>$\Longrightarrow$ When non-invertible or ill-conditioned, the inverse problem is ill-posed <b class="alert">with no unique solution $x$</b></span>
						<div class="container fragment fade-up">
							<div class="col">
								<img data-src="assets/pluto_smooth.png" class="plain"></img>
								Deconvolution
							</div>
							<div class="col">
								<img data-src="assets/pluto_missing.png" class="plain"></img>
								Inpainting
							</div>
							<div class="col">
								<img data-src="assets/plutoNoise.png" class="plain"></img>
								Denoising
							</div>
						</div>
					</section>

					<section>
						<h3 class="slide-title">Signal processing problem beyond
						astrophysics<br>
						Example: <b class="alert">MRI reconstruction</b></h3>
						
						<div class="fragment">
						<div style="position:absolute; left:180px; top:140px">
							<img data-src="assets/MRI_obs.png" class="plain"></img>
						</div>

						<div style="position:absolute; left:640px; top:125px">
							<img data-src="assets/MRI_signal.png" class="plain"></img>
						</div>

						<div style="position:absolute; left:550px">
							$$y = \mathbf{M} \mathbf{F} x + n$$
						</div>
					</div>

					<div class="fragment" style="position:absolute; top:550px; left:600px">
						<b class="alert">$p(x|y)$</b> $\propto p(y|x)p(x)$
						<br><br>
						<ul>
							<li class="fragment">$p(y|x) \sim \mathcal{N}(y|\mathbf{M}
							\mathbf{F} x , \Sigma_n)$</li>
							<br>
							<li class="fragment">$p(x)$ ??</li>
						</ul>
					</div>
						<!-- <div class="container fragment fade-up"> -->
						
						</section>

						<section>
							<h3 class="slide-title">Key concept: generative modeling</h3>
							<br />
							<ul>
							  <li>
								The goal of generative modeling is to
								<b
								  >learn an <b class="alert">implicit</b> distribution
								  $\mathbb{P}$</b
								>
								from which the
								<b>training set $X = \{x_0, x_1, \ldots, x_n \}$</b> is drawn.
							  </li>
							  <br />
							  <li class="fragment">
								Usually, this means building a parametric model
								$\mathbb{P}_\theta$ that tries to be close to $\mathbb{P}$.
							  </li>
							</ul>
				
							<br />
							<div class="container">
							  <div class="col fragment fade-up">
								<img
								  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756538/pasted-from-clipboard.png"
								  class="plain"
								/>
								<br />
								True $\mathbb{P}$
							  </div>
				
							  <div class="col fragment fade-up">
								<img
								  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756539/pasted-from-clipboard.png"
								  class="plain"
								/>
								<br />
								Samples $x_i \sim \mathbb{P}$
							  </div>
				
							  <div class="col fragment fade-up">
								<img
								  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756554/pasted-from-clipboard.png"
								  class="plain"
								/>
								<br />
								Model $\mathbb{P}_\theta$
							  </div>
							</div>
							<br />
							<br />
							<ul>
							  <li class="fragment">
								Once trained, you can typically 
								<b>sample from $\mathbb{P}_\theta$</b> and/or
								<b class="alert">evaluate the likelihood $p_\theta(x)$</b>.
							  </li>
							</ul>
						  </section>

						  <section>
							<h3 class="slide-title"> The evolution of generative models </h3>
				
							<br> 
							<div class='container'>
								<div class='col'>
									<div style="position:relative; width:600px; height:600px; margin:0 auto;">
										<img class="fragment current-visible plain" data-src="assets/DBN.png"
											style="position:absolute;top:0;left:0;width:500px;" data-fragment-index="0" />
										<img class="fragment current-visible plain" data-src="assets/vae_faces.jpg"
											style="position:absolute;top:0;left:0;width:500px;" data-fragment-index="1" />
										<img class="fragment current-visible plain" data-src="assets/gan-samples-1.png"
											style="position:absolute;top:0;left:0;width:500px;" data-fragment-index="2" />
										<img class="fragment plain" data-src="assets/karras2017.png"
											style="position:absolute;top:0;left:0;width:500px;" data-fragment-index="3" />
										<img class="fragment plain" data-src="assets/1670591463156314057.jpg"
										style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="4" />
									</div>
								</div>
				
								<div class='col'>
									<ul>
										<li class="fragment" data-fragment-index="0"> Deep Belief Network <br> (Hinton et al. 2006)
										</li>
										<br>
										<li class="fragment" data-fragment-index="1"> Variational AutoEncoder <br> (Kingma & Welling
											2014) </li>
										<br>
										<li class="fragment" data-fragment-index="2"> Generative Adversarial Network <br>
											(Goodfellow et al. 2014)</li>
										<br>
										<li class="fragment" data-fragment-index="3"> Wasserstein GAN <br> (Arjovsky et al. 2017)
										</li>
										<br>
										<li class="fragment"
										data-fragment-index="4"> Midjourney v5
										Guided <b class="alert">Diffusion</b> (2023)
										</li>
									</ul>
								</div>
							</div>
							<br> <br> <br>
						</section>

						<section>
							<h3 class="slide-title">The score is all you need!</h3>
							<br>
			
							<div class="container">
								<div class="col">
									<ul>
										<li>Our aim is to sample new data from a
										distribution $x \sim p(x)$</li> <br>
										<li class="fragment "> You
											<b class="alert">only need access to the score</b> of the distribution:
											<b class="alert">$$\frac{ \partial \log p(x )}{
											\partial
											x}$$</b>
											<!-- <ul> -->
												<!-- <li>Gradient descent: $x_{t+1} = x_t + \tau \nabla_x \log p(x_t) $</li> -->
												<!-- <li> -->
													e.g. Langevin algorithm: $x_{t+1}
													= x_t + \tau \nabla_x \log
													p(x_t) + \sqrt{2\tau} n_t$
												 <!-- </li> -->
											<!-- </ul> -->
										</li>
										<br>
									</ul>
								</div>
								<div class="col fragment">
									<img data-src="assets/score_two_moons.png"></img>
								</div>
							</div>
							<br>
							<br>
							<!-- <ul>
								<li class="fragment" data-fragment-index="1"> The score of the full posterior is simply:
									$$\nabla_x \log p(x |y) = \underbrace{\nabla_x \log p(y |x)}_{\mbox{known}} \quad + \quad \underbrace{\nabla_x \log p(x)}_{\mbox{can be learned}}$$
									$\Longrightarrow$ all we have to do is <b class="alert">model/learn the score of the prior</b>.
								</li>
							</ul> -->
						</section>


			<section>
				<h3 class="slide-title">Neural Score Estimation by <b class="alert">Denoising Score Matching</b></h3>

				<!-- <ul> -->
					<!-- <li><b>Denoising Score Matching</b>: An optimal <b class="alert">Gaussian denoiser learns the score</b> of a given distribution. -->
						<ul>
							<li class="fragment fade-up" data-fragment-index="1"> If $x \sim \mathbb{P}$ is corrupted by additional Gaussian noise $u \in \mathcal{N}(0, \sigma^2)$ to yield
								<span class="fragment"data-fragment-index="2">
									$$x^\prime = x + u$$
								</span>
							</li>
							<li class="fragment fade-up" data-fragment-index="3"> Let's consider a denoiser $r_\theta$ trained under an $\ell_2$ loss:
								
									$$\mathcal{L}=\parallel x -
									r_\theta(x^\prime, \sigma) \parallel_2^2$$
							</li>
							<li class="fragment fade-up" data-fragment-index="4"> The optimal denoiser $r_{\theta^\star}$ verifies:
							$$ \boxed{\color{orange}{\nabla_{\boldsymbol{x}} \log
							p_{\sigma^2}(\boldsymbol{x}')} = \dfrac{
							\boldsymbol{r}_{\theta^\star}(\boldsymbol{x}',
							\sigma) - \boldsymbol{x}'}{\sigma^2}
							}$$
							</li>
						</ul>
					<!-- </li>
				</ul> -->

				<!-- <div class="fragment fade-up"> -->
					<div class="container">
						<div class="fragment col" data-fragment-index="1">$\boldsymbol{x}$
							
							<img data-src="assets/cat_denoised.png" style='width:1200px;'></img>
						</div>

						<div class="fragment col" data-fragment-index="2">$\boldsymbol{x}'$							
							<vbr></vbr>
							<img data-src="assets/cat_noise.png" style='width:1200px;'></img>
						</div>

						<div class="fragment col" data-fragment-index="3" >$\boldsymbol{r}^\star(\boldsymbol{x}', \sigma)$
							<img data-src="assets/cat_denoised.png" style='width:1200px;'></img>
						</div>

						<div class="fragment col" data-fragment-index="4">$\color{orange}{\nabla_{\boldsymbol{x}} \log p_{\sigma^2}(\boldsymbol{x}')}$
							<img data-src="assets/noise_cat.png" style='width:1200px;'></img>
						</div>
					</div>
					<!-- <img data-src="/assets/denoised_mnist.png" style='width:1200px;'></img> -->
				<!-- </div> -->
			</section>


			<section>
				<h3 class="slide-title">Sampling method: <b class="alert">Annealed Hamiltonian Monte Carlo</b> </h3>
				<div align="left">
					Sampling convergence maps $\kappa \sim p(\kappa|\gamma)$ <b class="alert">is very difficult</b> due to the high dimensionality of the space <br> ( $360 \times 360 \approx 10^{5}$ parameters).
					
					<br>
					<br>
					Especially for MCMC algorithms because of <em>curse of dimensionality</em> leading to <em>highly correlated chains</em>.
				</div>
				<br>

				<div class="fragment">
					We need to design an efficient sampler. $~~~~x_1, x_2, ..., x_N \sim p(x|  y)$
				</div>
				<br>

				<div class="fragment">
				<div align="left">
					<ul>
						<!-- <li class="fragment"><b class="alert">Metropolis-Hastings:</b> correction step, acceptance probability (garanties to sample the right posterior distribution)</li> -->
						<br>
						<li><b class="alert">Hamiltonian Monte Carlo</b> proposal for a step size $\alpha$:
						</li>
				</div>
						$$\begin{array}{lcl} \boldsymbol{m}_{t+\frac{\alpha}{2}} & = & \boldsymbol{m}_t + \dfrac{\alpha}{2} \color{orange}{\nabla_{x}\log p(\boldsymbol{x}_t|y)} \\ 
						\boldsymbol{x}_{t+\alpha} & = & \boldsymbol{x}_t + \alpha \boldsymbol{\mathrm{M}}^{-1} \boldsymbol{x}_{t+\frac{\alpha}{2}} \\
 						\boldsymbol{m}_{t+\alpha} & = & \boldsymbol{m}_{t+\frac{\alpha}{2}} + \dfrac{\alpha}{2} \color{orange}{\nabla_x \log p (\boldsymbol{x}_{t+\alpha}|y)}
						\end{array}$$
 					
<!-- 						
						<li class="fragment"><b class="alert">Annealing:</b> convolve the posterior with a wide gaussian to always remain on high probability density.
							$$p_\sigma(x) = \int p_{\mathrm{data}}(x')\mathcal{N}(x|x', \sigma^2)dx', ~~~~~~~~\sigma_1 > \sigma_2 > \sigma_3 > \sigma_4 $$
						</li>
						 -->
					</ul>
				</div>
				
			</section>

			<section>
				<h3 class="slide-title">Efficient sampling by Annealed HMC</h3>

				<ul>
					<li> Even with gradients, <b class="alert">sampling in high number of dimensions is difficult!</b> Because of:<br>
						<ul>
							<li>Curse of dimensionality</li>
							<li>Highly correlated chains</li>
						</ul>
						<!-- <br> -->
						<li class="fragment fade-up>">$\Longrightarrow$ Use a <b class="alert">parallel annealing strategy</b> to effectively sample from full distribution.</li>
					</li>
					<!-- <br> -->
					<li class="fragment fade-up"> We use the fact that our score network $\mathbf{r}_\theta(x, \sigma)$ is learning a noise-convolved distribution 
						$\nabla \log p_\sigma$, where $$p_\sigma(x) = \int p_{\mathrm{data}}(x')\mathcal{N}(x|x', \sigma^2)dx', ~~~~~~~~\sigma_1 > \sigma_2 > \sigma_3 > \sigma_4 $$

						<div>
							<img data-src="assets/annealing.png" />
						</div>

					</li>

					<li class="fragment fade-up"> Run many HMC chains in parallel, progressively annealing the $\sigma$ to 0, <b class="chain">keep last point in the chain as independent sample</b>.
					</li>
				</ul>
			</section>

			<section>
				<h3 class="slide-title">Sampling method: <b class="alert">Annealed Hamiltonian Monte Carlo</b> </h3>
				<br>
				<!-- <div class="fragment">
					<div class="plain fragment current-visible " style="position:absolute;top:0;left:0;width:700px;" data-fragment-index="0">
						Initialization $\sigma_T$ is high
						<div>
							<img data-src="assets/annealing_begin.png" />
						</div>
					</div>	
					<div class="plain fragment current-visible " style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="1">
						
						<div>
							<img data-src="assets/annealing_target.png" />
						</div>
					</div>
				</div> -->
				<div class="block-content">
					<div style="position:relative; height:570px; top:0px; left:0px;">
						<div class="plain current-visible" data-fragment-index="1" style="position:absolute;top:0;left:0;width:1200px;" data-fragment-index="2">
							$\nabla_{x_t} \log p_\sigma({x_t} |y)$
							<span class="fragment"data-fragment-index="2">
							$\quad=\quad  \underset{\text{known}}{\underbrace{\nabla_{x_t} \log p_\sigma(y
							|{x_t})}}\quad$
							</span>
							<span class="fragment" data-fragment-index="3">
							$+\quad  \underset{\text{learned}}{\underbrace{\color{orange}{\nabla_{x_t} \log p_\sigma({x_t})}}}$
							<div class="fragment" data-fragment-index="2" style="position:relative; top:50px">
								<img data-src='assets/knees.png'
								style="width:600px;" />
							</div>
							<div class="fragment" data-fragment-index="4" style="position:relative; top:-400px">
							<img data-src='assets/mri_annealing.gif'
							style="width:1100px;" />
						</div>
						</span>
						</div>
					</div>
				</div>
			</section>
			
			<section>
				<h3 class="slide-title">Gravitational lensing as an Inverse Problem</h3>
				<div class="container">
					<div class="col">
						Shear <b class="alert">$\gamma$</b><br>
						<img data-src="assets/shear_cat1.png" style="width:450px;"></img>
					</div>

					<div class="col fragment fade-up">
						Convergence <b class="alert">$\kappa$</b><br>
						<img data-src="assets/kappa.png" style="width:450px;"></img>
					</div>
				</div>

				<div style="position:relative; width:1000px; height:100px; margin:0 auto;">
					<div class="fragment current-visible plain fade-up" style="position:absolute;top:0;left:0;width:1000px;">
						$$\gamma_1 = \frac{1}{2} (\partial_1^2 - \partial_2^2) \ \Psi \quad;\quad \gamma_2 = \partial_1 \partial_2 \ \Psi \quad;\quad \kappa = \frac{1}{2} (\partial_1^2 + \partial_2^2) \ \Psi$$
					</div>
					<div class="fragment current-visible plain fade-up" style="position:absolute;top:0;left:0;width:1000px;">
						$$\boxed{\gamma = \mathbf{P} \kappa + n}$$
					</div>
				</div>
			</section>
			
			<section>
				<h3 class="slide-title"> Illustration on the Dark Energy Survey (DES) Y3</h3>
				<div style="float:right; font-size: 20px">Jeffrey, et al. (2021)
				</div><br>
				<img data-src="assets/DESY3map.png" style="height:600px;"></img>
			</section>


			<section>
				<h3 class="slide-title">Illustration on $\kappa$-TNG simulations</h3>
				<div>
					$$\nabla_\kappa \log p_\sigma(\kappa |\gamma) = \nabla_\kappa \log p_\sigma(\gamma |\kappa) \quad + \quad  \color{orange}{\nabla_\kappa \log p_\sigma(\kappa)}$$
					<img data-src='assets/video-annealing.gif'/>
				</div>
			</section>


			<section>
				<h3 class="slide-title">Reconstruction of the <b class="alert">HST/ACS COSMOS field</b></h3>
				
				1.637 square degree, 64.2 gal/arcmin$^2$
				<br>
				<br>
				<div class="container">
					<div class="col">
						<div class="block-content">
							<div style="position:relative; height:570px; top:0px; left:0px;">
								Massey et al. (2007)
								<img data-src="assets/massey.png" style="height:500px;"></img>
							</div>
						</div>
					</div>

					<div class="col">
						<div class="block-content">
							<div style="position:relative; height:570px; top:0px; left:0px;">
								<div class="plain fragment current-visible " style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="0">
									Remy et al. (2022) <b class="alert">Posterior mean</b>
									<img data-src='assets/remy.png' style="height:500px;" />
								</div>

								<div class="plain fragment current-visible " style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="1">
									Remy et al. (2022) <b class="alert">Posterior samples</b>
									<img data-src='assets/cosmos_samples.gif' style="height:500px;" />
								</div>

								<div class="plain fragment current-visible " style="position:absolute;top:0;left:0;width:600px;" data-fragment-index="2">
									Remy et al. (2022)
									<img data-src='assets/COSMOS-std.png' style="height:500px;" />
								</div>
							</div>
						</div>
					</div>

				</div>
			</section>

			<section>
				<!-- <section> -->
					<h3 class="slide-title"> Takeaways</h3>
					
					<ul>
						<li class="fragment">
							<p><b class="alert">First time</b> sampling the full posterior of 
								high dimensional
								inverse problems in 2020! <br>(Remy et al. 2020, Ramzi et al. 2020, Remy et al. 2022)</p>
						<!-- <br> -->
						<div><video data-autoplay loop="loop" data-src="assets/knee.mp4" type="video/mp4" style="width: 1000px;" />
							</li>
						<br>
							<li class="fragment"> Hybrid physical/deep learning modeling:
							<ul>
								<li> Deep generative models can be used to provide <b class="alert">data driven (simulation based) priors</b>.
								</li>
								<br>
								<li> <b class="alert">Explicit likelihood</b>, uses of all of our physical knowledge.<br>
									$\Longrightarrow$ No need to re-train the
									network for different kinds of measurement!
								</li>
							</ul>
						</li>
						<br>
						<li class="fragment">
							Demonstrated the efficiency of annealing Hamiltoninan Monte Carlo for high dimensional posterior sampling.
						</li>
						<br>
						<!-- <li class="fragment"> Neural Score Estimation is a <b class="alert">scalable approach</b> to learn a prior score.
						</li>
						<br>
						<li class="fragment"> Knowledge of the posterior score is all we need for Bayesian inference aka uncertain quantification.
						</li>
						<br> -->
						<li class="fragment">Applies to a large class of inverse
						problems, astrophysical and beyond <br>
						<a href="https://arxiv.org/abs/2011.08271"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2011.08271-B31B1B.svg" class="plain" style="height:35px;" /></a>
					<a href="https://arxiv.org/abs/2011.08698" style='vertical-align:middle; display:inline;'><img
						src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg" class="plain" style="height:35px;" /></a>
			
					<br>
					<!-- <p class="fragment"> Thank you!</p> -->
					<br>
					<br>
			
				<!-- </section> -->
			</section>

			</section>

			<section>
				<section data-background-image="assets/lsst_stills_0009_crop.jpg">
					<div class="container">
						<div class="title" style="position:relative; left:200px; border-radius: 20px; background-color:rgba(0, 0, 0, 0.7);">
							<br>
							<h2> 
								Probabilistic inference & <br>
								model misspecification
							</h2>
							<!-- <h2>Joint Bayesian inference of galaxy morphologies and cosmic shear</h2> -->
							<center><hr size="100" width="600"></center>
							<center><hr size="100" width="400"></center>
							<center><hr size="100" width="900", style="opacity:0%"></center>
							<!-- <br> -->
							<p style="color:#B1CB11">
								<b class="alert">
								<u>B. Remy</u>, F. Lanusse, J.-L. Starck.<br>
								<em>
								Towards solving model bias in cosmic shear
								forward modeling,<br>
							</em>
								5th Machine Learning and the Physical Science workshop at NeurIPS, 2022.
							</b>
							</p>
						
						<a href="https://arxiv.org/abs/2210.16243"
										><img
											src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
											class="plain"
											style="height: 35px; vertical-align: middle"
									/></a>
						<br>
									<!-- <font size=4>B. Remy, Z. Ramzi, F. Lanusse, J. Liu, J.-L.
									Starck </font><br>
									<a href="https://arxiv.org/abs/2011.08271"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2011.08271-B31B1B.svg" class="plain" style="height:25px;" /></a>
						
							<br>

							<font size=4>Z. Ramzi, B. Remy, F. Lanusse, J.-L. Starck, P. Ciuciu </font><br>
							<a href="https://arxiv.org/abs/2011.08698" style='vertical-align:middle; display:inline;'><img
								src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg" class="plain" style="height:25px;" /></a>
					-->
								</div>

						
					</div>
				</section>

				<section>
					<h3 class="slide-title">
						Let us build a probabilistic model of galaxy images

					</h3>
					<!-- <div class="container">
						<div class="col">
							<div style="float: right; font-size: 20px">
								<b>Lanusse</b> et al. (2020)
								<a href="https://arxiv.org/abs/2008.03833"
									><img
										src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2008.03833-B31B1B.svg"
										class="plain"
										style="height: 25px; vertical-align: middle"
								/></a>
							</div>
						</div>
					</div> -->
					<div class="container">
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/rand_z_square.png"
								style="height: 150px"
								data-fragment-index="4"
							/>
						</div>
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_shear.png"
								style="width: 200px"
								data-fragment-index="3"
							/>
						</div>
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal.png"
								style="width: 200px"
								data-fragment-index="2"
							/>
						</div>

						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_psf.png"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     osmos_gal_psf.png"
								style="width: 200px"
								data-fragment-index="1"
							/>
						</div>

						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_ground.png"
								style="width: 200px"
								data-fragment-index="0"
							/>
						</div>
					</div>

					<div
						class="container"
						style="
							position: relative;
							width: 1000px;
							height: 50px;
							margin: 0 auto;
						"
					>
						<div class="col fragment" data-fragment-index="4">
							<font size="10"> $\longrightarrow$ </font> <br />
							$g_\theta$
						</div>
						<div class="col fragment" data-fragment-index="3">
							<font size="10"> $\longrightarrow$ </font> <br />
							shear $\gamma$
						</div>
						<div class="col fragment" data-fragment-index="2">
							<font size="10"> $\longrightarrow$ </font> <br />
							PSF
						</div>
						<div class="col fragment" data-fragment-index="1">
							<font size="10"> $\longrightarrow$ </font> <br />
							Noise
						</div>
					</div>

					<div class="container">
						<div class="col">
							<div
								style="
									position: relative;
									width: 400px;
									height: 300px;
									margin: 0 auto;
								"
							>
								<img
									data-src="assets/pgm_x.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="0"
								/>
								<img
									data-src="assets/pgm_xzs.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="1"
								/>
								<img
									data-src="assets/pgm_xzsp.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 350px"
									data-fragment-index="2"
								/>
								<img
									data-src="assets/pgm_xzsp_shear.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 350px"
									data-fragment-index="3"
								/>
								<img
									data-src="assets/pgm_full.png"
									class="plain fragment"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="4"
								/>
							</div>
						</div>
						<div class="col">
							<div class="block fragment" data-fragment-index="0">
								<div class="block-title">Probabilistic model</div>
								<div class="block-content">
									<div
										style="
											position: relative;
											width: 400px;
											height: 100px;
											margin: 0 auto;
										"
									>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="0"
										>
											$$ x \sim ? $$
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="1"
										>
											$$ x \sim \mathcal{N}(z, \Sigma) \quad z \sim ? $$<br />latent
											$z$ is a denoised galaxy image <br>
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="2"
										>
										$$ x \sim \mathcal{N}(\Pi \ast z, \Sigma)
										\quad z \sim ? $$<br />latent $z$ is a deconvolved,
										and denoised galaxy image
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 450px;
											"
											data-fragment-index="3"
										>
										$\begin{align}
										x \sim \mathcal{N}(\Pi \ast (z \otimes \gamma), \Sigma) \quad &  z \sim ? \\
										 & \gamma \sim \mathcal{N}(0, .05)
										\end{align}$

										<br />latent $z$ is a unsheared deconvolved,
										and denoised galaxy image
										</div>
										<div
											class="plain fragment"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 500px;
											"
											data-fragment-index="4"
										>
										$\begin{align}
										x \sim \mathcal{N}(\Pi \ast
											(g_\theta(z) \otimes \gamma), \Sigma) \quad & z \sim \mathcal{N}(0,
											\mathbf{I}) \\
										& \gamma \sim \mathcal{N}(0, .05)
										\end{align}$

											<!-- $$ x \sim \mathcal{N}(\Pi \ast
											(g_\theta(z) \otimes \gamma), \Sigma) \quad z \sim \mathcal{N}(0,
											\mathbf{I}) $$ <br />latent $z$ are morphological parameters<br /> -->
											<br />latent $z$ are morphological parameters<br />
											<b class="alert">
												$\theta$ are global parameters of the model</b
											>
										</div>
									</div>
									<br />
									<br />
									<br />
								</div>
							</div>
						</div>
					</div>
					<div class="fragment">
						$\Longrightarrow$
						<b class="alert">
							Decouples the morphology model from the observing conditions</b
						>.
					</div>
				</section>

				<section>
					<h3 class="slide-title">Bayesian modeling of cosmic shear</h3>
					<div align="left">
					We aim to model the posterior distribution $p(\gamma|\mathcal{D})$ <br><br>

					<div class="fragment">
					$\begin{align}
					p(\gamma|\mathcal{D}) &= \int p(\gamma, z, \Pi|\mathcal{D}) ~dz~d\Pi \\
					\end{align}$
				</div>
				<div class="fragment">
					$\begin{align}
					~~~~~~~~~~~&= \int \color{#B1CB11}{\underbrace{p(\mathcal{D}|\gamma, z, \Pi)}_{\text{likelihood}}} \underbrace{p(\gamma)p(z)p(\Pi)}_{\text{priors}} ~dz~d\Pi
					\end{align}$
				</div>
					<br>
					
					<div class="fragment">
					The likelihood $\color{#B1CB11}{p(\mathcal{D}|\gamma, z, \Pi)}$ is naturally built from the forward model <br>
						<div align="center">
					<img class="plain" style="height:300px" data-src="assets/great.jpg" />
				</div>
				</div>
				</div>

				</section>

				<section>
					<h3 class="slide-title">Joint inference using a parametric model for the morphology</h3>
					<div align="left">
					Let's assume that $g(z)$ is a <b class="alert">sersic model</b>, i.e. $z = \{n, r_\text{hlr}, F, e_1, e_2, s_x, s_y\}$ and 
					$$g(z) = F \times I_0 \exp \left( -b_n \left[\left( \frac{r}{r_\text{hlr}}\right)^{\frac{1}{n}} -1\right] \right)$$
					
					<div class="fragment">
						The joint inference of $p(z, \gamma | \mathcal{D})$ leads to a <b class="alert">biased posterior</b>...
					
						<div class="container">
							<div class="col" align="center">
								<img src="assets/shear_estimate_bias.png" class="plain" height="300"></img>
								<br>
								Marginal shear posterior $p(\gamma|\mathcal{D})$
							</div>

							<div class="col fragment">
								<img src="assets/sersic_fit.png" class="plain" height="300"></img>
								<br>
								Maximum a posteriori fit and residuals
							</div>
						</div>
					</div>

					<div class="fragment" align="center"> <br>
						...due to model misspecification <b class="fragment">$\longrightarrow$ <b class="alert">Let's learn a more flexible $g_\theta$</b></b>
					</div>
				</section>

<!-- 
				<section>
					<h3 class="slide-title">Joint inference using a parametric model for the morphology</h3>
				</section> -->

				<section data-auto-animate style="height: 2100px; width:3500px">
					<h3 class="slide-title">
						Learning from corrupted data
					</h3>
					<!-- <h3 style="opacity: 0.3; font-size: 18px;">SLIDE 1</h2>
					<h2 data-id="title" style="margin-top: 260px;">Animate Anything</h2> -->

					<div style="position: absolute; top: 40px; left: 800px; font-size: 20px">Lanusse et al. 2020 <a href="https://arxiv.org/abs/2008.03833" style='vertical-align:middle; display:inline;'><img
						src="https://img.shields.io/badge/astro--ph-arXiv%3A2008.03833-B31B1B.svg" class="plain" style="height:25px;" /></a>
					</div>

					<div data-id="111" style="position: absolute; top: 250px; left: 176px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 0; width: 200px"
					/>

					<div data-id="21" style="position: absolute; top: 370px; left: 210px; width: 100px; height: 200px; font-size: 80%;" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Inference network}$ </div>
					<div data-id="22" style="position: absolute; top: 370px; left: 450px; width: 100px; height: 200px; font-size: 80%;" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Generator network}$ </div>
					<div data-id="23" style="position: absolute; top: 100px; left: 250px; width: 100px; height: 200px; font-size: 80%;" > $q_\phi(z|x)$ </div>
					<div data-id="24" style="position: absolute; top: 100px; left: 475px; width: 100px; height: 200px; font-size: 80%;" > $p_\theta(x|z)$ </div>

					<div data-id="26" style="position: absolute; top: 190px; left: 355px; width: 100px; height: 200px; font-size: 50%;" > $z \sim q_\phi(z|x)$ </div>

					<div data-id="1" style="background: white; position: absolute; top: 150px; left: 220px; width: 15px; height: 230px;"></div>
					<div data-id="2" style="background: white; position: absolute; top: 150px; left: 260px; width: 15px; height: 230px;"></div>
					<div data-id="3" style="background: white; position: absolute; top: 150px; left: 300px; width: 15px; height: 230px;"></div>
					<div data-id="4" style="background: white; position: absolute; top: 150px; left: 340px; width: 15px; height: 230px;"></div>

					<div data-id="11" style="position: absolute; top: 250px; left: 233px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="12" style="position: absolute; top: 250px; left: 273px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="13" style="position: absolute; top: 250px; left: 313px; width: 15px; height: 200px;">$\rightarrow$</div>
					
					<div data-id="14" style="position: absolute; top: 250px; left: 353px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="3" style="background: white; position: absolute; top:220px; left: 397px; width: 15px; height: 100px;"></div>

					<div data-id="15" style="position: absolute; top: 250px; left: 410px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="5" style="background: white; position: absolute; top: 150px; left: 455px; width: 15px; height: 230px;"></div>
					<div data-id="6" style="background: white; position: absolute; top: 150px; left: 495px; width: 15px; height: 230px;"></div>
					<div data-id="7" style="background: white; position: absolute; top: 150px; left: 535px; width: 15px; height: 230px;"></div>
					<div data-id="8" style="background: white; position: absolute; top: 150px; left: 575px; width: 15px; height: 230px;"></div>
					
					<div data-id="16" style="position: absolute; top: 250px; left: 468px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="17" style="position: absolute; top: 250px; left: 508px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="18" style="position: absolute; top: 250px; left: 548px; width: 15px; height: 200px;">$\rightarrow$</div>

					<div data-id="19" style="position: absolute; top: 250px; left: 587px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="9" style="background: white; position: absolute; top: 150px; left: 631px; width: 15px; height: 0;"></div>

					<img data-id="33"
					data-src="assets/noisy_gal.png"
					style="position: absolute; top: 145px; left: 605px; width: 200px"
					/>

					<div data-id="24" style="position: absolute; top: 150px; left: 650px; width: 100px; height: 200px; font-size: 80%;" > $x' \sim p_\theta(x|z)$ </div>

				</section>


				<section data-auto-animate style="height: 1000px; width:1390px">
					<h3 class="slide-title">
						Learning from corrupted data
					</h3>

					<div style="position: absolute; top: 40px; left: 800px; font-size: 20px">Lanusse et al. 2020 <a href="https://arxiv.org/abs/2008.03833" style='vertical-align:middle; display:inline;'><img
						src="https://img.shields.io/badge/astro--ph-arXiv%3A2008.03833-B31B1B.svg" class="plain" style="height:25px;" /></a>
					</div>

					<div data-id="111" style="position: absolute; top: 250px; left: 176px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 0; width: 200px"
					/>

					<div data-id="21" style="position: absolute; top: 370px; left: 210px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Inference network}$ </div>
					<div data-id="22" style="position: absolute; top: 370px; left: 450px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Generator network}$ </div>
					<div data-id="23" style="position: absolute; top: 100px; left: 250px; width: 100px; height: 200px; font-size: 80%;" > $q_\phi(z|x)$ </div>
					<div data-id="24" style="position: absolute; top: 100px; left: 475px; width: 100px; height: 200px; font-size: 80%;" > $p_\theta(x|z)$ </div>

					<div data-id="26" style="position: absolute; top: 190px; left: 355px; width: 100px; height: 200px; font-size: 50%;" > $z \sim q_\phi(z|x)$ </div>

					<div data-id="1" style="background: white; position: absolute; top: 150px; left: 220px; width: 15px; height: 230px;"></div>
					<div data-id="2" style="background: white; position: absolute; top: 150px; left: 260px; width: 15px; height: 230px;"></div>
					<div data-id="3" style="background: white; position: absolute; top: 150px; left: 300px; width: 15px; height: 230px;"></div>
					<div data-id="4" style="background: white; position: absolute; top: 150px; left: 340px; width: 15px; height: 230px;"></div>

					<div data-id="11" style="position: absolute; top: 250px; left: 233px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="12" style="position: absolute; top: 250px; left: 273px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="13" style="position: absolute; top: 250px; left: 313px; width: 15px; height: 200px;">$\rightarrow$</div>
					
					<div data-id="14" style="position: absolute; top: 250px; left: 353px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="3" style="background: white; position: absolute; top:220px; left: 397px; width: 15px; height: 100px;"></div>

					<div data-id="15" style="position: absolute; top: 250px; left: 410px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="5" style="background: white; position: absolute; top: 150px; left: 455px; width: 15px; height: 230px;"></div>
					<div data-id="6" style="background: white; position: absolute; top: 150px; left: 495px; width: 15px; height: 230px;"></div>
					<div data-id="7" style="background: white; position: absolute; top: 150px; left: 535px; width: 15px; height: 230px;"></div>
					<div data-id="8" style="background: white; position: absolute; top: 150px; left: 575px; width: 15px; height: 230px;"></div>
					
					<div data-id="16" style="position: absolute; top: 250px; left: 468px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="17" style="position: absolute; top: 250px; left: 508px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="18" style="position: absolute; top: 250px; left: 548px; width: 15px; height: 200px;">$\rightarrow$</div>

					<div data-id="19" style="position: absolute; top: 250px; left: 587px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="9" style="background: #B1CB11; position: absolute; top: 150px; left: 631px; width: 15px; height: 230px;"></div>
					<div data-id="22" style="position: absolute; top: 400px; left: 590px; width: 100px; height: 200px; font-size: 80%;" > $g_\theta(z)$ </div>

					<div data-id="99" style="background: #6495ED; position: absolute; top: 150px; left: 691px; width: 15px; height: 0px;"></div>

					<div data-id="24" style="position: absolute; top: 150px; left: 770px; width: 100px; height: 200px; font-size: 80%;" > $x' \sim p_\theta(x|z)$ </div>

					<img data-id="33"
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 726px; width: 200px"
					/>

				</section>


				<!-- <section data-auto-animate style="height: 800px; width:900px"> -->
					<section data-auto-animate style="height: 1000px; width:1300px">
						<h3 class="slide-title">
							Learning from corrupted data
						</h3>

						<div style="position: absolute; top: 40px; left: 800px; font-size: 20px">Lanusse et al. 2020 <a href="https://arxiv.org/abs/2008.03833" style='vertical-align:middle; display:inline;'><img
							src="https://img.shields.io/badge/astro--ph-arXiv%3A2008.03833-B31B1B.svg" class="plain" style="height:25px;" /></a>
						</div>

					<div data-id="111" style="position: absolute; top: 250px; left: 176px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 0; width: 200px"
					/>

					<div data-id="21" style="position: absolute; top: 370px; left: 210px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Inference network}$ </div>
					<div data-id="22" style="position: absolute; top: 370px; left: 450px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Generator network}$ </div>
					<div data-id="23" style="position: absolute; top: 100px; left: 250px; width: 100px; height: 200px; font-size: 80%;" > $q_\phi(z|x)$ </div>
					<div data-id="24" style="position: absolute; top: 100px; left: 475px; width: 100px; height: 200px; font-size: 80%;" > $p_\theta(x|z)$ </div>

					<div data-id="26" style="position: absolute; top: 190px; left: 355px; width: 100px; height: 200px; font-size: 50%;" > $z \sim q_\phi(z|x)$ </div>

					<div data-id="1" style="background: white; position: absolute; top: 150px; left: 220px; width: 15px; height: 230px;"></div>
					<div data-id="2" style="background: white; position: absolute; top: 150px; left: 260px; width: 15px; height: 230px;"></div>
					<div data-id="3" style="background: white; position: absolute; top: 150px; left: 300px; width: 15px; height: 230px;"></div>
					<div data-id="4" style="background: white; position: absolute; top: 150px; left: 340px; width: 15px; height: 230px;"></div>

					<div data-id="11" style="position: absolute; top: 250px; left: 233px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="12" style="position: absolute; top: 250px; left: 273px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="13" style="position: absolute; top: 250px; left: 313px; width: 15px; height: 200px;">$\rightarrow$</div>
					
					<div data-id="14" style="position: absolute; top: 250px; left: 353px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="3" style="background: white; position: absolute; top:220px; left: 397px; width: 15px; height: 100px;"></div>

					<div data-id="15" style="position: absolute; top: 250px; left: 410px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="5" style="background: white; position: absolute; top: 150px; left: 455px; width: 15px; height: 230px;"></div>
					<div data-id="6" style="background: white; position: absolute; top: 150px; left: 495px; width: 15px; height: 230px;"></div>
					<div data-id="7" style="background: white; position: absolute; top: 150px; left: 535px; width: 15px; height: 230px;"></div>
					<div data-id="8" style="background: white; position: absolute; top: 150px; left: 575px; width: 15px; height: 230px;"></div>
					
					<div data-id="16" style="position: absolute; top: 250px; left: 468px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="17" style="position: absolute; top: 250px; left: 508px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="18" style="position: absolute; top: 250px; left: 548px; width: 15px; height: 200px;">$\rightarrow$</div>

					<div data-id="19" style="position: absolute; top: 250px; left: 587px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="9" style="background: #B1CB11; position: absolute; top: 150px; left: 631px; width: 15px; height: 230px;"></div>
					<div data-id="22" style="position: absolute; top: 400px; left: 590px; width: 100px; height: 200px; font-size: 80%;" > $g_\theta(z)$ </div>

					<div data-id="119" style="position: absolute; top: 250px; left: 665px; width: 15px; height: 200px;">$\ast$</div>

					<div data-id="99" style="background: #6495ED; position: absolute; top: 150px; left: 695px; width: 15px; height: 230px;"></div>

					<div data-id="27" style="position: absolute; top: 400px; left: 653px; width: 100px; height: 200px; font-size: 80%;" > $\Pi$ </div>

					<div data-id="24" style="position: absolute; top: 150px; left: 770px; width: 100px; height: 200px; font-size: 80%;" > $x' \sim p_\theta(x|z, \Pi, \Sigma)$ </div>

					<div data-id="55" style="position: absolute; top: 250px; left: 709px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<img data-id="33"
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 726px; width: 200px"
					/>

				</section>


				<section data-auto-animate style="height: 1000px; width:1300px">
					<h3 class="slide-title">
						Learning from corrupted data
					</h3>

					<div style="position: absolute; top: 40px; left: 800px; font-size: 20px">Lanusse et al. 2020 <a href="https://arxiv.org/abs/2008.03833" style='vertical-align:middle; display:inline;'><img
						src="https://img.shields.io/badge/astro--ph-arXiv%3A2008.03833-B31B1B.svg" class="plain" style="height:25px;" /></a>
					</div>

					<div data-id="111" style="position: absolute; top: 250px; left: 176px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 0; width: 200px"
					/>

					<div data-id="21" style="position: absolute; top: 370px; left: 210px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Inference network}$ </div>
					<div data-id="22" style="position: absolute; top: 370px; left: 450px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Generator network}$ </div>
					<div data-id="23" style="position: absolute; top: 100px; left: 250px; width: 100px; height: 200px; font-size: 80%;" > $q_\phi(z|x)$ </div>
					<div data-id="24" style="position: absolute; top: 100px; left: 475px; width: 100px; height: 200px; font-size: 80%;" > $p_\theta(x|z)$ </div>

					<div data-id="26" style="position: absolute; top: 190px; left: 355px; width: 100px; height: 200px; font-size: 50%;" > $z \sim q_\phi(z|x)$ </div>

					<div data-id="1" style="background: white; position: absolute; top: 150px; left: 220px; width: 15px; height: 230px;"></div>
					<div data-id="2" style="background: white; position: absolute; top: 150px; left: 260px; width: 15px; height: 230px;"></div>
					<div data-id="3" style="background: white; position: absolute; top: 150px; left: 300px; width: 15px; height: 230px;"></div>
					<div data-id="4" style="background: white; position: absolute; top: 150px; left: 340px; width: 15px; height: 230px;"></div>

					<div data-id="11" style="position: absolute; top: 250px; left: 233px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="12" style="position: absolute; top: 250px; left: 273px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="13" style="position: absolute; top: 250px; left: 313px; width: 15px; height: 200px;">$\rightarrow$</div>
					
					<div data-id="14" style="position: absolute; top: 250px; left: 353px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="3" style="background: white; position: absolute; top:220px; left: 397px; width: 15px; height: 100px;"></div>

					<div data-id="15" style="position: absolute; top: 250px; left: 410px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="5" style="background: white; position: absolute; top: 150px; left: 455px; width: 15px; height: 230px;"></div>
					<div data-id="6" style="background: white; position: absolute; top: 150px; left: 495px; width: 15px; height: 230px;"></div>
					<div data-id="7" style="background: white; position: absolute; top: 150px; left: 535px; width: 15px; height: 230px;"></div>
					<div data-id="8" style="background: white; position: absolute; top: 150px; left: 575px; width: 15px; height: 230px;"></div>
					
					<div data-id="16" style="position: absolute; top: 250px; left: 468px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="17" style="position: absolute; top: 250px; left: 508px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="18" style="position: absolute; top: 250px; left: 548px; width: 15px; height: 200px;">$\rightarrow$</div>

					<div data-id="19" style="position: absolute; top: 250px; left: 587px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="9" style="background: #B1CB11; position: absolute; top: 150px; left: 631px; width: 15px; height: 230px;"></div>
					<div data-id="22" style="position: absolute; top: 400px; left: 590px; width: 100px; height: 200px; font-size: 80%;" > $g_\theta(z)$ </div>

					<div data-id="119" style="position: absolute; top: 250px; left: 665px; width: 15px; height: 200px;">$\ast$</div>

					<div data-id="99" style="background: #6495ED; position: absolute; top: 150px; left: 695px; width: 15px; height: 230px;"></div>

					<div data-id="27" style="position: absolute; top: 400px; left: 653px; width: 100px; height: 200px; font-size: 80%;" > $\Pi$ </div>

					<div data-id="24" style="position: absolute; top: 150px; left: 770px; width: 100px; height: 200px; font-size: 80%;" > $x' \sim p_\theta(x|z, \Pi, \Sigma)$ </div>

					<div data-id="55" style="position: absolute; top: 250px; left: 709px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img data-id="33"
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 726px; width: 200px"
					/>

					<div data-id="32" style="position: absolute; top: 410px; left: 612px; width: 100px; height: 200px; font-size: 100%;" > $\underbrace{\quad \quad \quad}_{g_\theta(z) \ast \Pi}$ </div>
					<div data-id="31" style="position: absolute; top: 456px; left: 709px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img data-id="66"
							data-src="assets/autoencoded_gal.png"
							style="position: absolute; top: 350px; left: 726px; width: 200px"
					/>

				</section>


				<section data-auto-animate style="height: 1000px; width:1300px">
					<h3 class="slide-title">
						Learning from corrupted data
					</h3>

					<div style="position: absolute; top: 40px; left: 800px; font-size: 20px">Lanusse et al. 2020 <a href="https://arxiv.org/abs/2008.03833" style='vertical-align:middle; display:inline;'><img
						src="https://img.shields.io/badge/astro--ph-arXiv%3A2008.03833-B31B1B.svg" class="plain" style="height:25px;" /></a>
					</div>

					<div data-id="111" style="position: absolute; top: 250px; left: 176px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 0; width: 200px"
					/>

					<div data-id="21" style="position: absolute; top: 370px; left: 210px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Inference network}$ </div>
					<div data-id="22" style="position: absolute; top: 370px; left: 450px; width: 100px; height: 200px; font-size: 80%; opacity:0.3" > $\underbrace{\quad \quad \quad \quad \quad \quad}_\textrm{Generator network}$ </div>
					<div data-id="23" style="position: absolute; top: 100px; left: 250px; width: 100px; height: 200px; font-size: 80%;" > $q_\phi(z|x)$ </div>
					<div data-id="24" style="position: absolute; top: 100px; left: 475px; width: 100px; height: 200px; font-size: 80%;" > $p_\theta(x|z)$ </div>

					<div data-id="26" style="position: absolute; top: 190px; left: 355px; width: 100px; height: 200px; font-size: 50%;" > $z \sim q_\phi(z|x)$ </div>

					<div data-id="1" style="background: white; position: absolute; top: 150px; left: 220px; width: 15px; height: 230px;"></div>
					<div data-id="2" style="background: white; position: absolute; top: 150px; left: 260px; width: 15px; height: 230px;"></div>
					<div data-id="3" style="background: white; position: absolute; top: 150px; left: 300px; width: 15px; height: 230px;"></div>
					<div data-id="4" style="background: white; position: absolute; top: 150px; left: 340px; width: 15px; height: 230px;"></div>

					<div data-id="11" style="position: absolute; top: 250px; left: 233px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="12" style="position: absolute; top: 250px; left: 273px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="13" style="position: absolute; top: 250px; left: 313px; width: 15px; height: 200px;">$\rightarrow$</div>
					
					<div data-id="14" style="position: absolute; top: 250px; left: 353px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="3" style="background: white; position: absolute; top:220px; left: 397px; width: 15px; height: 100px;"></div>

					<div data-id="15" style="position: absolute; top: 250px; left: 410px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="5" style="background: white; position: absolute; top: 150px; left: 455px; width: 15px; height: 230px;"></div>
					<div data-id="6" style="background: white; position: absolute; top: 150px; left: 495px; width: 15px; height: 230px;"></div>
					<div data-id="7" style="background: white; position: absolute; top: 150px; left: 535px; width: 15px; height: 230px;"></div>
					<div data-id="8" style="background: white; position: absolute; top: 150px; left: 575px; width: 15px; height: 230px;"></div>
					
					<div data-id="16" style="position: absolute; top: 250px; left: 468px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="17" style="position: absolute; top: 250px; left: 508px; width: 15px; height: 200px;">$\rightarrow$</div>
					<div data-id="18" style="position: absolute; top: 250px; left: 548px; width: 15px; height: 200px;">$\rightarrow$</div>

					<div data-id="19" style="position: absolute; top: 250px; left: 587px; width: 15px; height: 200px;">$\longrightarrow$</div>

					<div data-id="9" style="background: #B1CB11; position: absolute; top: 150px; left: 631px; width: 15px; height: 230px;"></div>
					<div data-id="22" style="position: absolute; top: 400px; left: 590px; width: 100px; height: 200px; font-size: 80%;" > $g_\theta(z)$ </div>

					<div data-id="119" style="position: absolute; top: 250px; left: 665px; width: 15px; height: 200px;">$\ast$</div>

					<div data-id="99" style="background: #6495ED; position: absolute; top: 150px; left: 695px; width: 15px; height: 230px;"></div>

					<div data-id="27" style="position: absolute; top: 400px; left: 653px; width: 100px; height: 200px; font-size: 80%;" > $\Pi$ </div>

					<div data-id="24" style="position: absolute; top: 150px; left: 770px; width: 100px; height: 200px; font-size: 80%;" > $x' \sim p_\theta(x|z, \Pi, \Sigma)$ </div>

					<div data-id="55" style="position: absolute; top: 250px; left: 709px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img data-id="33"
							data-src="assets/noisy_gal.png"
							style="position: absolute; top: 145px; left: 726px; width: 200px"
					/>

					<div data-id="32" style="position: absolute; top: 410px; left: 612px; width: 100px; height: 200px; font-size: 100%;" > $\underbrace{\quad \quad \quad}_{g_\theta(z) \ast \Pi}$ </div>
					<div data-id="31" style="position: absolute; top: 456px; left: 709px; width: 15px; height: 200px;">$\longrightarrow$</div>
					
					<img data-id="66"
							data-src="assets/autoencoded_gal.png"
							style="position: absolute; top: 350px; left: 726px; width: 200px"
					/>

					<div align="left" style="position: absolute; top: 510px; left: 0px;"> Optimized maximizing the <b class="alert">ELBO</b> 
					<br>
					<br>
					$\log p(x) \geq \mathbb{E}_{z\sim q_\phi(z|x)} \left[ \log p_\theta(x|z, \Pi, \Sigma) + \mathbb{D}_\text{KL}(q_\phi \| p(z)) \right]$
					</div>

				</section>

				<section>
					<h3 class="slide-title">
						A generative model for galaxy morphologies
					</h3>
					<div class="container">
						<div class="col">
							<img
								data-src="assets/pgm.png"
								class="plain"
								style="height: 250px"
							/>
						</div>
						<div class="col">
							The Bayesian view of the problem: $$ p(z | x ) \propto
							p_\theta(x | z, \Sigma, \mathbf{\Pi}) p(z)$$ where:
							<br />
							<ul>
								<li>$p( z | x )$ is the <b class="alert">posterior</b></li>
								<li>
									$p( x | z )$ is the data likelihood,
									<b class="alert">contains the physics</b>
								</li>
								<li>$p( z )$ is the <b>prior</b></li>
							</ul>
						</div>
					</div>

					<div class="container">
						<div class="col">
							<div
								style="
									position: relative;
									width: 200px;
									height: 200px;
									margin: 0 auto;
								"
							>
								<img
									class="plain fragment current-visible"
									data-src="assets/cosmos_gal_ground.png"
									style="position: absolute; top: 0; left: 0; width: 200px"
									data-fragment-index="0"
								/>
								<img
									class="plain fragment"
									data-src="assets/cosmos_gal.png"
									style="position: absolute; top: 0; left: 0; width: 200px"
									data-fragment-index="1"
								/>
							</div>
							<div
								class="container"
								style="
									position: relative;
									width: 200px;
									height: 50px;
									margin: 0 auto;
								"
							>
								<div
									class="col fragment current-visible"
									data-fragment-index="0"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									Data<br />
									$x_n$
								</div>
								<div
									class="col fragment"
									data-fragment-index="1"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									Truth<br />
									$x_0$
								</div>
							</div>
							<br />
						</div>

						<div class="col fragment" data-fragment-index="0">
							<div
								style="
									position: relative;
									width: 200px;
									height: 200px;
									margin: 0 auto;
								"
							>
								<div>
									<video
										data-autoplay
										data-loop
										data-src="assets/rec_samples.mp4"
										type="video/mp4"
										style="height: 200px"
									/>
								</div>
							</div>
							<div>
								Posterior samples<br />
								$g_\theta(z)$
							</div>
						</div>

						<div class="col">
							<div
								style="
									position: relative;
									width: 200px;
									height: 200px;
									margin: 0 auto;
								"
							>
								<div>
									<video
										class="fragment current-visible"
										data-autoplay
										data-loop
										data-src="assets/rec_lsst.mp4"
										type="video/mp4"
										style="position: absolute; top: 0; left: 0; width: 200px"
										data-fragment-index="0"
									/>
								</div>
								<img
									class="plain fragment"
									data-src="assets/rec_median.png"
									style="position: absolute; top: 0; left: 0; width: 200px"
									data-fragment-index="1"
								/>
							</div>

							<div
								class="container"
								style="
									position: relative;
									width: 200px;
									height: 50px;
									margin: 0 auto;
								"
							>
								<div
									class="col fragment current-visible"
									data-fragment-index="0"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									<br />
									$\mathbf{P} (\Pi \ast g_\theta(z))$
								</div>
								<div
									class="col fragment"
									data-fragment-index="1"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									Median
								</div>
							</div>
						</div>

						<div class="col">
							<div
								style="
									position: relative;
									width: 200px;
									height: 200px;
									margin: 0 auto;
								"
							>
								<div>
									<video
										class="fragment current-visible"
										data-autoplay
										data-loop
										data-src="assets/res_lsst.mp4"
										type="video/mp4"
										style="position: absolute; top: 0; left: 0; width: 200px"
										data-fragment-index="0"
									/>
								</div>
								<img
									class="plain fragment"
									data-src="assets/rec_std.png"
									style="position: absolute; top: 0; left: 0; width: 200px"
									data-fragment-index="1"
								/>
							</div>

							<div
								class="container"
								style="
									position: relative;
									width: 200px;
									height: 50px;
									margin: 0 auto;
								"
							>
								<div
									class="col fragment current-visible"
									data-fragment-index="0"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									Data residuals <br />
									$x_n - \mathbf{P} (\Pi \ast g_\theta(z))$
								</div>
								<div
									class="col fragment"
									data-fragment-index="1"
									style="position: absolute; top: 0; left: 0; width: 200px"
								>
									Standard Deviation
								</div>
							</div>
						</div>
					</div>
					<div class="fragment">
						$\Longrightarrow$
						<b class="alert"
							>Uncertainties are fully captured by the posterior</b
						>.
					</div>
				</section>

				<section>
					<h3 class="slide-title">Joint inference using a generative model for the morphology</h3>
					<div class="container">
						<div class="col">
							<div style="float: right; font-size: 20px">
								<b>Remy</b>, Lanusse, Starck (2022)
								<a href="https://arxiv.org/abs/2210.16243"
									><img
										src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
										class="plain"
										style="height: 25px; vertical-align: middle"
								/></a>
							</div>
						</div>
					</div>
					<div align="left">
					Let's use the learned $g_\theta(z)$ <br><br>
					
					<div class="fragment">
						The joint inference of $p(z, \gamma | \mathcal{D})$ leads to an <b class="alert">unbiased posterior</b>!<br><br>
					
						<div class="container">
							<div class="col" align="center">
								<img src="assets/shear_estimate_nobias.png" class="plain" height="300"></img>
								<br>
								Marginal shear posterior $p(\gamma|\mathcal{D})$
							</div>

							<div class="col fragment">
								<img src="assets/deepgal1.png" class="plain" height="300"></img>
								<br>
								Maximum a posteriori fit and residuals
							</div>
						</div>
					</div>

					<!-- <div class="fragment" align="center"> <br>
						<b class="alert">Using the ge</b>
					</div> -->
				</section>

				<section>
					<h3 class="slide-title">Takeaway message</h3>
					
					<div class="fragment" style="position:relative; left:150px; width:1000px; border-radius: 20px; background-color:rgba(228, 240, 160, 0.055);">
						<br>
							<ul>
								<!-- <li class="fragment">  -->
								<li>
									<b class="alert">Ellipticity</b> is not a well defined quantity for arbitrary galaxies $\rightarrow$ bias in shear estimation
									
								</li>
	
								<br>
	
								<li class="fragment">
									<b class="alert">Forward modeling</b> allows to decouple morphology from observing conditions
									<ul>
										<br>
										<li> <b class="alert">Deep generative models</b> can be used to provide flexible light profile model</b>
										</li>
										<br>
										<li> <b class="alert">Explicit likelihood</b>: uses of all of our physical knowledge<br>
											$ + $ Our method can be applied for varying PSF, noise, or even different instruments!
										</li>
			
									</ul>
								</li>
								
								<br>
							<li class="fragment">
								<b class="alert">Variational Inference</b> enables fast inference in a few minutes compared to hours with HMC ($\mathcal{O}(10^4)$ parameters)
							</li>
							
							</ul>

							<br><br>
							
							<div class="fragment">
								<strong> $\Longrightarrow$ Joint inference of morpholgy and shear leads to <b class="alert">unbiased</b> marginal shear posterior</strong>
	
							</div>
							<br>
						</div>
								
					<div class="fragment">
						<a href="https://arxiv.org/abs/2210.16243"
											><img
												src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
												class="plain"
												style="height: 35px; vertical-align: middle"
										/></a>
						<br>
					
					</div>
					
					<!-- <p class="fragment" align="left" style="position:relative; left:100px">Opening remarks</p>
				<div class="fragment" style="position:relative; left:150px; width:1000px; border-radius: 20px; background-color:rgba(228, 240, 160, 0.055);">
						<ul>
							<li>
								Shear estimators are known to <b
								class="alert">respond to galaxy selection</b>,
								how to include galaxy detection and selection
								in the bayesian framework?
							</li>
							
							<li class="fragment">
								Galaxy that are observed <b
								class="alert">blended</b> may be affected by a
								different amount of shear. How to handle blended objects?
							</li>	
						</ul>
					</div> -->
					
				</section>

			</section>
			<section>			
			<section>
				<h3 class="slide-title" style="position:relative;top:0;">
					Other works
				</h3>

				<b class="alert">Neural Posterior Estimation with Differentiable Simulators</b>
				<br>
				<small>
				Justine Zeghal, François Lanusse, Alexandre Boucaud, <u>Benjamin Remy</u>, Eric Aubourg
				<br>
				(ICML 2022 Workshop on Machine Learning for Astrophysics)
			</small>
				<br>
				<br>
				$\mathcal{L} = \mathbb{E}_{p(\text{x}, z, \theta)} \left[ - \log p_{\varphi} (\theta | \text{x})  \right] + \color{orange}{\mathbb{E}_{p(\text{x},z,\theta)} \left[ \parallel \nabla_{\theta} \log p(\theta | \text{x}, z)  - \nabla_\theta \log p_\varphi(\theta | \text{x}) \parallel_2^2 \right]}$
				<br>
				<br>
				<div class="container">
					<div class="col">
					    <img src="assets/2moons_truth.png" class="plain" height="350"></img>
					</div>
					<div class="col">
						
					    <img src="assets/tight_prior_lotkavolterra_c2st_2.png" class="plain" height="350"></img>
					</div>
				</div>
			</section>

			<section>
				<h3 class="slide-title" style="position:relative;top:0;">
					Other works
				</h3>

				<b class="alert">Deblending & Training diffusion models from corrupted data</b>
				<div class="container">
					<div class="col">
						<img src="assets/deblending_sampson.png" class="plain" height="550"></img>
						<div align="left">
							<small><a style="color:#6e93d6" href="https://arxiv.org/abs/2401.07313">Sampson et al. 2023</a></small>
						</div>
					</div>

					<div class="col">
						<div align="left">
							<small>
						$\texttt{Scarlet2}$: Differentiable forward model in JAX and Equinox
						<ul>
							<li>
								Galaxy spectrum and morphology
							</li>
							<li>
								Convolution/deconvolution
							</li>
							<li>
								2D interpolation (Bilinear, Lancsoz, Cubic, Quintic)
							</li>
						</ul>
						<br>
						<br>

						
						Application to Time Domain Astrophysics <br>	

						<b class="alert">Disentangling transients and their host galaxies with scarlet2: A framework to forward model multi-epoch imaging
						</b><br>
						C. Ward, P. Melchior, M. L. Sampson, C. J. Burke, J. Siegel, <u>B. Remy</u>, S. Birmingham, E. Ramey, S. van Velzen, Astronomy & Astrophysics 2024
						<br><br>
						<b class="alert">Learning diffusion models from observations</b>
						<br>
						(inspired from <a style="color:#6e93d6" href="https://arxiv.org/abs/2405.13712">Rozet et al. 2024</a>)
						<img src="assets/diffusion-prior.png" class="plain" height="350"></img>
					</small>	
					</div>

					</div>


				</div>

			</section>
			</section>

			<section>

				<section>
					<h3 class="slide-title" style="position:relative;top:0;">
						Research Plans: Equivariant Deep Learning on the Sphere
					</h3>


					<div class="container">
						<div class="col">
							<div align="left">Upcomming cosmological surveys will be on a spherical manifold
							</div>
							<img src="assets/skymap-2016.jpg" class="plain" height="350"></img>
							<br>
							<a style="color:#6e93d6" href="https://www.lsst.org/scientists/simulations/opsim">Vera C. Rubin strategy</a>
						</div>

						<div class="col">
							We need <b class="alert">equivariant deep leanring</b> for
							<ul>
								<br>
								<li>
									Optimal compression into summarry statistics with <b class="alert">information bottleneck</b> methods
								</li>
								<br>
								<li>
									Or invariant implicit inference
								</li>
								<br>
								<li>
									Diffusion/Generative models on the sphere for fast simulations generation and application beyond cosmology (e.g. Climate Science, weather forcasting, etc.)
								</li>
							</ul>
						</div>

					</div>
				</section>

				<section>
					<h3 class="slide-title" style="position:relative;top:0;">
						Research Plans: Equivariant Deep Learning on the Sphere
					</h3>


					<div class="container">
						<div class="col">
							<!-- <div align="left">Upcomming cosmological surveys will be on a spherical manifold
							</div> -->
							<img src="assets/scattering-simbig.png" class="plain" height="450"></img>
							<br>
							<a style="color:#6e93d6" href="https://arxiv.org/abs/2310.15250">Régaldo-Saint Blancard et al. 2023</a>
						</div>

						<div class="col">
							Combining wavelet scattering transform and deep learning for <b class="alert">simulation efficient</b>
							 and <b class="alert">robust</b> simulation-based inference
							<br>
							<br>
							<br>
							 <ul>
								<li>
									<b class="alert">Scattering transform</b> have natural extension to the sphere
								</li>
								<br>
								<li>
									If scattering transforms not optimal, neural networks can be trained to <b class="alert">learn the residual information</b>
								</li>
								
							 </ul>
						</div>
					</div>
				</section>

				<section>
					<h3 class="slide-title" style="position:relative;top:0;">
						Research Plans: Scalable Variational Inference
					</h3>


				<div class="container">
					<div class="col" align="center">
						<img src="assets/shear_estimate_nobias.png" class="plain" height="300"></img>
						<br>
						Marginal shear posterior $p(\gamma|\mathcal{D})$
					</div>

						<div class="col">
							In this example:
							<br>
							<ul>
								<li>
									<b class="alert">Mean-field</b> approximation does not give the correct correlations/uncertainties
								</li>
								<br>
								<li>
									<b class="alert">Normalizing Flows</b> are over paramatrized or hard to optimize
								</li>
								<br>
								<li>
									I am interested in <b class="alert">EigenVI</b> approach with flexible surrogate distribution, 
									and see how these approches <b class="alert">scale with dimension</b>
								</li>
							</ul>
						</div>
					</div>
				</section>

				<section>
					<h3 class="slide-title" style="position:relative;top:0;">
						Research Plans: Optimal Compression with Minimal Simulations: Leveraging Foundation Models
					</h3>


				<div class="container">
					<div class="col" align="center">
						<img src="assets/sims.png" class="plain" height="400"></img>
						
					</div>

						<div class="col">
							Most realistic cosmological simulations are very expensive, but required for SBI

							<br>
							<br>
							<ul>
								<li>
								<b class="alert">Pretrain</b> encoders on large-scale, computationally inexpensive simulations (e.g. Particle Mesh simulations), with information bottleneck
								</li>
								<br>
								<li>
									<b class="alert">Fine-tune</b> on high-resolution hydrodynamical simulations, (e.g. CAMELS suite) with different stratigies (e.g. contrastive loss)
								</li>
							<br>
							<li>
								Multiple probes as multiple modalities
							</li>
							</ul>


						</div>
					</div>
				</section>


			</section>

		</div>
	</div>

	<style>
		/* .reveal .slides {
			border: 5px solid red;
			min-height: 100%;
			width: 128mm;
			height: 96mm;
		} */

		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}

		.reveal .block-title {
			background-color: #333333;
			padding: 8px 35px 8px 14px;
			color: #E1F9B7
;
			font-weight: bold;
		}

		.reveal .block-content {
			padding: 8px 35px 8px 14px;
		}

		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}

		.reveal .alert {
			/*color: #FFAA7F; */
			color: #B1CB11;
			font-weight: bold;
		}

		.reveal .inverted {
			filter: invert(100%);
		}

		/*
	/* .reveal .alert {
	padding:8px 35px 8px 14px; margin-bottom:18px;
	text-shadow:0 1px 0 rgba(255,255,255,1);
	border:5px solid #FFAA7F;
	-webkit-border-radius: 14px; -moz-border-radius: 14px;
	border-radius:14px
	background-position: 10px 10px;
	background-repeat: no-repeat;
	background-size: 38px;
	padding-left: 30px; /* 55px; if icon
	}
	.reveal .alert-block {padding-top:14px; padding-bottom:14px}
	.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
	/*.reveal .alert li {margin-top: 1em}
	.reveal .alert-block p+p {margin-top:5px} */
	</style>


	<script src="reveal.js/dist/reveal.js"></script>
	<script src="reveal.js/plugin/notes/notes.js"></script>
	<script src="reveal.js/plugin/markdown/markdown.js"></script>
	<script src="reveal.js/plugin/highlight/highlight.js"></script>
	<script src="reveal.js/plugin/math/math.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			controls: false,

			//center: false,
			hash: true,

			// Visibility rule for backwards navigation arrows; "faded", "hidden"
			// or "visible"
			controlsBackArrows: 'hidden',

			// Display a presentation progress bar
			progress: true,

			// Display the page number of the current slide
			slideNumber: true,

			transition: 'slide', // none/fade/slide/convex/concave/zoom

			// The "normal" size of the presentation, aspect ratio will be preserved
			// when the presentation is scaled to fit different resolutions. Can be
			// specified using percentage units.
			width: 1280,
			height: 720,

			// Factor of the display size that should remain empty around the content
			margin: 0.1,

			// Bounds for smallest/largest possible scale to apply to content
			minScale: 0.2,
			maxScale: 1.5,


			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],

			dependencies: [{
					src: 'reveal.js/plugin/markdown/marked.js'
				},
				{
					src: 'reveal.js/plugin/markdown/markdown.js'
				},
				{
					src: 'reveal.js/plugin/notes/notes.js',
					async: true
				},
				{
					src: 'reveal.js/plugin/math/math.js',
					async: true
				},
				{
					src: 'reveal.js/plugin/reveal.js-d3/reveald3.js'
				},
				{
					src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js'
				},
				{
					src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js'
				},
				{
					src: 'reveal.js/plugin/highlight/highlight.js',
					async: true
				},
			]

		});
	</script>
</body>

</html>

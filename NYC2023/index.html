<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Tosca kick-off 2023</title>

	<meta name="description" content="April 2022">
	<link rel="stylesheet" href="reveal.js/dist/reset.css">
	<link rel="stylesheet" href="reveal.js/dist/reveal.css">
	<link rel="stylesheet" href="reveal.js/dist/theme/darkenergy.css" id="theme">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="reveal.js/plugin/highlight/monokai.css" id="highlight-theme">
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section data-background-image="assets/lsst_stills_0009_crop.jpg">
				<div class="container">
					<div class="title" style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.6);">
						<h1>Unbiased shear estimation with forward modeling</h1>
						<h2>Joint Bayesian inference of galaxy morphologies and cosmic shear</h2>
					</div>
				</div>
				<!-- <hr> -->
				<!-- <div>
					<a href="https://arxiv.org/abs/2201.05561"><img src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2201.05561-B31B1B.svg" class="plain" style="height:25px;" /></a>
					<a href="https://arxiv.org/abs/2011.08698"><img src="https://img.shields.io/badge/stat.ML-arXiv%3A2011.08698-B31B1B.svg" class="plain" style="height:25px;" /></a>
				</div> -->
				<div class="container">
					<div class="col">
						<div align="left" style="margin-left: 20px">
							<!-- <div style="color:#511e00"> -->
							<h2>
								<!-- <div style="color:#511e00"> -->
									Benjamin Remy
								<!-- </div> -->
							</h2>
							with Francois Lanusse, Jean-Luc Starck
						<!-- </div> -->
							<img src="assets/CosmoStatDarkBK.png" class="plain"></img>
							<br>
						</div>
					</div>

					<div class="col">
						<br>
						<br>
						<br>
						<img src="assets/logo_cnes.png" class="plain" height="150"></img>
					</div>

					<div class="col">
						<br>
						<br>
						<img src="assets/universite_paris_saclay.jpg" class="plain" height="150"></img>
					</div>
				</div>
				<div style="border-radius: 20px; background-color:rgba(0, 0, 0, 0.6);"> slides at <a href="https://b-remy.github.io/talks/TOSCA2023">b-remy.github.io/talks/TOSCA2023</a> </div>

			</section>

			<section>
				<section data-background-image="assets/gravitational-lensing-diagram.jpg">
					<h3 class="slide-title"> Gravitational lensing</h3>
					<div class="fragment fade-up">
						<img class="plain" data-src="assets/great.jpg" />

					<div class="block ">
						<div class="block-title">
							Galaxy shapes as estimators for gravitational shear
						</div>
						<div class="block-content">
							$$ e = \gamma + e_i \qquad \mbox{ with } \qquad e_i \sim \mathcal{N}(0, I)$$
							<ul>
								<li> Standard methods are trying the measure the <b class="alert"> ellipticity $e$</b> of
									galaxies as an estimator for the <b class="alert">gravitational shear $\gamma$ </b>
								</li>
							</ul>
						</div>
					</div>

					</div>
				</section>


				<section>
					<h3 class="slide-title">Measuring galaxies ellipticity</h3>
					
					<br>
					<br>
					
					<div class="container">
							
						<div class="col" >
							<img src="assets/gaussian_fit_no_e.png" class="plain" width="500px"></img>
						</div>

						<div class="col fragment fade-up" align="left">
							<!-- <div style="position:relative; width:500; margin:0 auto;"> -->

							Moments-based method <br><br>
							
							$\begin{align}
								F &=  \sum G(x, y)I(x, y)\\
								\sigma^2 &= \sum G(x, y)^2 \sigma^2(I(x, y)) \\
								T &= \sum G(x, y)I(x, y)(x^2 + y^2) \\
								M_1 &= \sum G(x, y)I(x, y)(x^2 - y^2) \\
								M_2 &= \sum G(x, y)I(x, y)2xy \\
								\color{orange}{e_1} &\color{orange}{=} \color{orange}{M_1 / T}\\
								\color{orange}{e_2} &\color{orange}{=} \color{orange}{M_2 / T} \\
								S/N &= F / \sigma(F) \\
							\end{align}$
							<br>

						</div>
					</div>
					
					

						<!-- <div class="fragment" style="position:relative; width:1000px; height:100px; margin:0 auto;">
							<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
							The <b class="alert">ellipticity</b> is not necessarily a well defined quantity for arbitrary galaxyies,<br>leading to bias in cosmic shear estimation...
						</div> -->
				</section>

				<section>
					<h3 class="slide-title">Measuring galaxies ellipticity</h3>
					
						<div class="container">
							<div class="col" >
								<img src="assets/gaussian_fit.png" class="plain" width="500px"></img>
							</div>

							<div class="col" align="left">
								<!-- <br><br> -->
								Model fitting <br><br>
								
								$\begin{align}
								I(x, y) &= F \cdot \mathcal{N}\left( 0, \color{orange}{\Sigma} \right)\\

								\color{orange}{(e_1, e_2)} &\color{orange}{=} \color{orange}{f(\Sigma)}
								\end{align}$

								<br><br>

								<div class="fragment">
								What about real galaxies? <br>
								
								<div class="container">
									<div class="col">
										<div align="left" style="margin-left: 0px">
										<img data-src="assets/real_gal-inv-small.png" style='width:500px;'></img>
									</div>
									</div>
									<div class="col fragment">
										<div align="left" style="margin-left: -150px">
										<img data-src="assets/real_gal-inv.png" style='height:300px;'></img>
									</div>
									</div>
								</div>
								<br>
							</div>
							
						</div>
					</div>
					
						<div class="fragment">
							The <b class="alert">ellipticity</b> is not necessarily a well defined quantity for arbitrary galaxyies,<br>leading to bias in cosmic shear estimation... Need for calibration
						</div>
				</section>
				
				
				<!-- <section>
					<h3 class="slide-title">Calibrating shear estimator based on shape measurement</h3>
						
					Metacalibration, Metadetection	
				
				</section> -->
			</section>


			<section>
				<section>
					<h3 class="slide-title">Bayesian modeling of cosmic shear</h3>
					<div align="left">
					We aim to model the posterior distribution $p(\gamma|\mathcal{D})$ <br><br>

					<div class="fragment">
					$\begin{align}
					p(\gamma|\mathcal{D}) &= \int p(\gamma, z, \Pi|\mathcal{D}) ~dz~d\Pi \\
					\end{align}$
				</div>
				<div class="fragment">
					$\begin{align}
					~~~~~~~~~~~&= \int \color{orange}{\underbrace{p(\mathcal{D}|\gamma, z, \Pi)}_{\text{likelihood}}} \underbrace{p(\gamma)p(z)p(\Pi)}_{\text{priors}} ~dz~d\Pi
					\end{align}$
				</div>
					<br>
					
					<div class="fragment">
					The likelihood $\color{orange}{p(\mathcal{D}|\gamma, z, \Pi)}$ is naturally built from the forward model <br>
						<div align="center">
					<img class="plain" style="height:300px" data-src="assets/great.jpg" />
				</div>
				</div>
				</div>

				</section>

				<section>
					<h3 class="slide-title">
						Writing the likelihood
					</h3>
					<!-- <div class="container">
						<div class="col">
							<div style="float: right; font-size: 20px">
								<b>Lanusse</b> et al. (2020)
								<a href="https://arxiv.org/abs/2008.03833"
									><img
										src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2008.03833-B31B1B.svg"
										class="plain"
										style="height: 25px; vertical-align: middle"
								/></a>
							</div>
						</div>
					</div> -->
					<div class="container">
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/rand_z_square.png"
								style="height: 150px"
								data-fragment-index="4"
							/>
						</div>
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_shear.png"
								style="width: 200px"
								data-fragment-index="3"
							/>
						</div>
						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal.png"
								style="width: 200px"
								data-fragment-index="2"
							/>
						</div>

						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_psf.png"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     osmos_gal_psf.png"
								style="width: 200px"
								data-fragment-index="1"
							/>
						</div>

						<div class="col">
							<img
								class="plain fragment"
								data-src="assets/cosmos_gal_ground.png"
								style="width: 200px"
								data-fragment-index="0"
							/>
						</div>
					</div>

					<div
						class="container"
						style="
							position: relative;
							width: 1000px;
							height: 50px;
							margin: 0 auto;
						"
					>
						<div class="col fragment" data-fragment-index="4">
							<font size="10"> $\longrightarrow$ </font> <br />
							$g_\theta$
						</div>
						<div class="col fragment" data-fragment-index="3">
							<font size="10"> $\longrightarrow$ </font> <br />
							shear $\gamma$
						</div>
						<div class="col fragment" data-fragment-index="2">
							<font size="10"> $\longrightarrow$ </font> <br />
							PSF
						</div>
						<div class="col fragment" data-fragment-index="1">
							<font size="10"> $\longrightarrow$ </font> <br />
							Noise
						</div>
					</div>

					<div class="container">
						<div class="col">
							<div
								style="
									position: relative;
									width: 400px;
									height: 300px;
									margin: 0 auto;
								"
							>
								<img
									data-src="assets/pgm_x.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="0"
								/>
								<img
									data-src="assets/pgm_xzs.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="1"
								/>
								<img
									data-src="assets/pgm_xzsp.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 350px"
									data-fragment-index="2"
								/>
								<img
									data-src="assets/pgm_xzsp_shear.png"
									class="plain fragment current-visible"
									style="position: absolute; top: 0; left: 0; height: 350px"
									data-fragment-index="3"
								/>
								<img
									data-src="assets/pgm_full.png"
									class="plain fragment"
									style="position: absolute; top: 0; left: 0; height: 300px"
									data-fragment-index="4"
								/>
							</div>
						</div>
						<div class="col">
							<div class="block fragment" data-fragment-index="0">
								<div class="block-title">Probabilistic model</div>
								<div class="block-content">
									<div
										style="
											position: relative;
											width: 400px;
											height: 100px;
											margin: 0 auto;
										"
									>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="0"
										>
											$$ x \sim ? $$
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="1"
										>
											$$ x \sim \mathcal{N}(z, \Sigma) \quad z \sim ? $$<br />latent
											$z$ is a denoised galaxy image
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 400px;
											"
											data-fragment-index="2"
										>
										$$ x \sim \mathcal{N}(\Pi \ast z, \Sigma)
										\quad z \sim ? $$<br />latent $z$ is a deconvolved,
										and denoised galaxy image
										</div>
										<div
											class="plain fragment current-visible"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 450px;
											"
											data-fragment-index="3"
										>
										$$ x \sim \mathcal{N}(\Pi \ast (z \otimes \gamma), \Sigma)
										\quad z \sim ? $$<br />latent $z$ is a unsheared deconvolved,
										and denoised galaxy image
										</div>
										<div
											class="plain fragment"
											style="
												position: absolute;
												top: 0;
												left: 0;
												width: 500px;
											"
											data-fragment-index="4"
										>
											$$ x \sim \mathcal{N}(\Pi \ast
											(g_\theta(z) \otimes \gamma), \Sigma) \quad z \sim \mathcal{N}(0,
											\mathbf{I}) $$ <br />latent $z$ are morphological parameters<br />
											<b class="alert">
												$\theta$ are global parameters of the model</b
											>
										</div>
									</div>
									<br />
									<br />
									<br />
								</div>
							</div>
						</div>
					</div>
					<div class="fragment">
						$\Longrightarrow$
						<b class="alert">
							Decouples the morphology model from the observing conditions</b
						>.
					</div>
				</section>

				<section>
					<h3 class="slide-title">Joint inference using a parametric model for the morphology</h3>
					<div align="left">
					Let's assume that $g(z)$ is a <b class="alert">sersic model</b>, i.e. $z = \{n, r_\text{hlr}, F, e_1, e_2, s_x, s_y\}$ and 
					$$g(z) = F \times I_0 \exp \left( -b_n \left[\left( \frac{r}{r_\text{hlr}}\right)^{\frac{1}{n}} -1\right] \right)$$
					
					<div class="fragment">
						The joint inference of $p(z, \gamma | \mathcal{D})$ leads to a <b class="alert">biased posterior</b>...
					
						<div class="container">
							<div class="col" align="center">
								<img src="assets/shear_estimate_bias.png" class="plain" height="300"></img>
								<br>
								Marginal shear posterior $p(\gamma|\mathcal{D})$
							</div>

							<div class="col fragment">
								<img src="assets/sersic_fit.png" class="plain" height="300"></img>
								<br>
								Maximum a posteriori fit and residuals
							</div>
						</div>
					</div>

					<div class="fragment" align="center"> <br>
						<b class="alert">Let's learn a more flexible $g_\theta$</b>
					</div>
				</section>

				</section>

				<section>
					<section>
            <h3 class="slide-title">Key concept: generative modeling</h3>
            <br />
            <ul>
              <li>
                The goal of generative modeling is to
                <b
                  >learn an <b class="alert">implicit</b> distribution
                  $\mathbb{P}$</b
                >
                from which the
                <b>training set $X = \{x_0, x_1, \ldots, x_n \}$</b> is drawn.
              </li>
              <br />
              <li class="fragment">
                Usually, this means building a parametric model
                $\mathbb{P}_\theta$ that tries to be close to $\mathbb{P}$.
              </li>
            </ul>

            <br />
            <div class="container">
              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756538/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                True $\mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756539/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Samples $x_i \sim \mathbb{P}$
              </div>

              <div class="col fragment fade-up">
                <img
                  data-src="https://s3.amazonaws.com/media-p.slid.es/uploads/866922/images/7756554/pasted-from-clipboard.png"
                  class="plain"
                />
                <br />
                Model $\mathbb{P}_\theta$
              </div>
            </div>
            <br />
            <br />
            <ul>
              <li class="fragment">
                Once trained, you can typically
                <b>sample from $\mathbb{P}_\theta$</b> and/or
                <b class="alert">evaluate the likelihood $p_\theta(x)$</b>.
              </li>
            </ul>
          </section>

					
						<section>
							<h3 class="slide-title" style="position: absolute; top: 0">
								A Physicist's approach to deconvolution
							</h3>
							<div class="container">
								<div class="col">
									<div style="float: right; font-size: 20px">
										<b>Lanusse</b> et al. (2020)
										<a href="https://arxiv.org/abs/2008.03833"
											><img
												src="https://img.shields.io/badge/astro--ph.IM-arXiv%3A2008.03833-B31B1B.svg"
												class="plain"
												style="height: 25px; vertical-align: middle"
										/></a>
									</div>
								</div>
							</div>
							<div class="container">
								<div class="col">
									<img
										class="plain fragment"
										data-src="assets/rand_z_square.png"
										style="height: 150px"
										data-fragment-index="4"
									/>
								</div>
								<div class="col">
									<img
										class="plain fragment"
										data-src="assets/cosmos_gal.png"
										style="width: 200px"
										data-fragment-index="3"
									/>
								</div>
								<div class="col">
									<img
										class="plain fragment"
										data-src="assets/cosmos_gal_psf.png"
										style="width: 200px"
										data-fragment-index="2"
									/>
								</div>
	
								<div class="col">
									<img
										class="plain fragment"
										data-src="assets/cosmos_gal_pix.png"
										style="width: 200px"
										data-fragment-index="1"
									/>
								</div>
	
								<div class="col">
									<img
										class="plain fragment"
										data-src="assets/cosmos_gal_ground.png"
										style="width: 200px"
										data-fragment-index="0"
									/>
								</div>
							</div>
	
							<div
								class="container"
								style="
									position: relative;
									width: 1000px;
									height: 50px;
									margin: 0 auto;
								"
							>
								<div class="col fragment" data-fragment-index="4">
									<font size="10"> $\longrightarrow$ </font> <br />
									$g_\theta$
								</div>
								<div class="col fragment" data-fragment-index="3">
									<font size="10"> $\longrightarrow$ </font> <br />
									PSF
								</div>
								<div class="col fragment" data-fragment-index="2">
									<font size="10"> $\longrightarrow$ </font> <br />
									Pixelation
								</div>
								<div class="col fragment" data-fragment-index="1">
									<font size="10"> $\longrightarrow$ </font> <br />
									Noise
								</div>
							</div>
	
							<div class="container">
								<div class="col">
									<div
										style="
											position: relative;
											width: 400px;
											height: 300px;
											margin: 0 auto;
										"
									>
										<img
											data-src="assets/pgm_0.png"
											class="plain fragment current-visible"
											style="position: absolute; top: 0; left: 0; height: 300px"
											data-fragment-index="0"
										/>
										<img
											data-src="assets/pgm_1.png"
											class="plain fragment current-visible"
											style="position: absolute; top: 0; left: 0; height: 300px"
											data-fragment-index="1"
										/>
										<img
											data-src="assets/pgm_1.png"
											class="plain fragment current-visible"
											style="position: absolute; top: 0; left: 0; height: 350px"
											data-fragment-index="2"
										/>
										<img
											data-src="assets/pgm_2.png"
											class="plain fragment current-visible"
											style="position: absolute; top: 0; left: 0; height: 350px"
											data-fragment-index="3"
										/>
										<img
											data-src="assets/pgm_3.png"
											class="plain fragment"
											style="position: absolute; top: 0; left: 0; height: 300px"
											data-fragment-index="4"
										/>
									</div>
								</div>
								<div class="col">
									<div class="block fragment" data-fragment-index="0">
										<div class="block-title">Probabilistic model</div>
										<div class="block-content">
											<div
												style="
													position: relative;
													width: 400px;
													height: 100px;
													margin: 0 auto;
												"
											>
												<div
													class="plain fragment current-visible"
													style="
														position: absolute;
														top: 0;
														left: 0;
														width: 400px;
													"
													data-fragment-index="0"
												>
													$$ x \sim ? $$
												</div>
												<div
													class="plain fragment current-visible"
													style="
														position: absolute;
														top: 0;
														left: 0;
														width: 400px;
													"
													data-fragment-index="1"
												>
													$$ x \sim \mathcal{N}(z, \Sigma) \quad z \sim ? $$<br />latent
													$z$ is a denoised galaxy image
												</div>
												<div
													class="plain fragment current-visible"
													style="
														position: absolute;
														top: 0;
														left: 0;
														width: 400px;
													"
													data-fragment-index="2"
												>
													$$ x \sim \mathcal{N}( \mathbf{P} z, \Sigma) \quad z
													\sim ?$$<br />latent $z$ is a super-resolved and
													denoised galaxy image
												</div>
												<div
													class="plain fragment current-visible"
													style="
														position: absolute;
														top: 0;
														left: 0;
														width: 400px;
													"
													data-fragment-index="3"
												>
													$$ x \sim \mathcal{N}( \mathbf{P} (\Pi \ast z), \Sigma)
													\quad z \sim ? $$<br />latent $z$ is a deconvolved,
													super-resolved, and denoised galaxy image
												</div>
												<div
													class="plain fragment"
													style="
														position: absolute;
														top: 0;
														left: 0;
														width: 400px;
													"
													data-fragment-index="4"
												>
													$$ x \sim \mathcal{N}( \mathbf{P} (\Pi \ast
													g_\theta(z)), \Sigma) \quad z \sim \mathcal{N}(0,
													\mathbf{I}) $$ <br />latent $z$ is a Gaussian sample<br />
													<b class="alert">
														$\theta$ are parameters of the model</b
													>
												</div>
											</div>
											<br />
											<br />
											<br />
										</div>
									</div>
								</div>
							</div>
							<div class="fragment">
								$\Longrightarrow$
								<b class="alert">
									Decouples the morphology model from the observing conditions</b
								>.
							</div>
						</section>

						<section>
							<h3 class="slide-title">
								A generative model for galaxy morpgologies
							</h3>
							<div class="container">
								<div class="col">
									<img
										data-src="assets/pgm.png"
										class="plain"
										style="height: 250px"
									/>
								</div>
								<div class="col">
									The Bayesian view of the problem: $$ p(z | x ) \propto
									p_\theta(x | z, \Sigma, \mathbf{\Pi}) p(z)$$ where:
									<br />
									<ul>
										<li>$p( z | x )$ is the <b class="alert">posterior</b></li>
										<li>
											$p( x | z )$ is the data likelihood,
											<b class="alert">contains the physics</b>
										</li>
										<li>$p( z )$ is the <b>prior</b></li>
									</ul>
								</div>
							</div>
	
							<div class="container">
								<div class="col">
									<div
										style="
											position: relative;
											width: 200px;
											height: 200px;
											margin: 0 auto;
										"
									>
										<img
											class="plain fragment current-visible"
											data-src="assets/cosmos_gal_ground.png"
											style="position: absolute; top: 0; left: 0; width: 200px"
											data-fragment-index="0"
										/>
										<img
											class="plain fragment"
											data-src="assets/cosmos_gal.png"
											style="position: absolute; top: 0; left: 0; width: 200px"
											data-fragment-index="1"
										/>
									</div>
									<div
										class="container"
										style="
											position: relative;
											width: 200px;
											height: 50px;
											margin: 0 auto;
										"
									>
										<div
											class="col fragment current-visible"
											data-fragment-index="0"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											Data<br />
											$x_n$
										</div>
										<div
											class="col fragment"
											data-fragment-index="1"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											Truth<br />
											$x_0$
										</div>
									</div>
									<br />
								</div>
	
								<div class="col fragment" data-fragment-index="0">
									<div
										style="
											position: relative;
											width: 200px;
											height: 200px;
											margin: 0 auto;
										"
									>
										<div>
											<video
												data-autoplay
												data-loop
												data-src="assets/rec_samples.mp4"
												type="video/mp4"
												style="height: 200px"
											/>
										</div>
									</div>
									<div>
										Posterior samples<br />
										$g_\theta(z)$
									</div>
								</div>
	
								<div class="col">
									<div
										style="
											position: relative;
											width: 200px;
											height: 200px;
											margin: 0 auto;
										"
									>
										<div>
											<video
												class="fragment current-visible"
												data-autoplay
												data-loop
												data-src="assets/rec_lsst.mp4"
												type="video/mp4"
												style="position: absolute; top: 0; left: 0; width: 200px"
												data-fragment-index="0"
											/>
										</div>
										<img
											class="plain fragment"
											data-src="assets/rec_median.png"
											style="position: absolute; top: 0; left: 0; width: 200px"
											data-fragment-index="1"
										/>
									</div>
	
									<div
										class="container"
										style="
											position: relative;
											width: 200px;
											height: 50px;
											margin: 0 auto;
										"
									>
										<div
											class="col fragment current-visible"
											data-fragment-index="0"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											<br />
											$\mathbf{P} (\Pi \ast g_\theta(z))$
										</div>
										<div
											class="col fragment"
											data-fragment-index="1"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											Median
										</div>
									</div>
								</div>
	
								<div class="col">
									<div
										style="
											position: relative;
											width: 200px;
											height: 200px;
											margin: 0 auto;
										"
									>
										<div>
											<video
												class="fragment current-visible"
												data-autoplay
												data-loop
												data-src="assets/res_lsst.mp4"
												type="video/mp4"
												style="position: absolute; top: 0; left: 0; width: 200px"
												data-fragment-index="0"
											/>
										</div>
										<img
											class="plain fragment"
											data-src="assets/rec_std.png"
											style="position: absolute; top: 0; left: 0; width: 200px"
											data-fragment-index="1"
										/>
									</div>
	
									<div
										class="container"
										style="
											position: relative;
											width: 200px;
											height: 50px;
											margin: 0 auto;
										"
									>
										<div
											class="col fragment current-visible"
											data-fragment-index="0"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											Data residuals <br />
											$x_n - \mathbf{P} (\Pi \ast g_\theta(z))$
										</div>
										<div
											class="col fragment"
											data-fragment-index="1"
											style="position: absolute; top: 0; left: 0; width: 200px"
										>
											Standard Deviation
										</div>
									</div>
								</div>
							</div>
							<div class="fragment">
								$\Longrightarrow$
								<b class="alert"
									>Uncertainties are fully captured by the posterior</b
								>.
							</div>
						</section>

						<section>
							<h3 class="slide-title">Joint inference using a generative model for the morpholgy</h3>
							<div class="container">
								<div class="col">
									<div style="float: right; font-size: 20px">
										<b>Remy</b>, Lanusse, Starck (2022)
										<a href="https://arxiv.org/abs/2210.16243"
											><img
												src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
												class="plain"
												style="height: 25px; vertical-align: middle"
										/></a>
									</div>
								</div>
							</div>
							<div align="left">
							Let's use the leared $g_\theta(z)$ <br><br>
							
							<div class="fragment">
								The joint inference of $p(z, \gamma | \mathcal{D})$ leads to an <b class="alert">unbiased posterior</b>!<br><br>
							
								<div class="container">
									<div class="col" align="center">
										<img src="assets/shear_estimate_nobias.png" class="plain" height="300"></img>
										<br>
										Marginal shear posterior $p(\gamma|\mathcal{D})$
									</div>
		
									<div class="col fragment">
										<img src="assets/deepgal1.png" class="plain" height="300"></img>
										<br>
										Maximum a posteriori fit and residuals
									</div>
								</div>
							</div>
		
							<!-- <div class="fragment" align="center"> <br>
								<b class="alert">Using the ge</b>
							</div> -->
						</section>

			<section>
				<h3 class="slide-title">Takeaway message</h3>
				<br>
					<br>
					<ul>
						<li class="fragment"> 
							The <b class="alert">ellipticity</b> is not a well defined quantity for arbitrary galaxies, leading to bias in shear estimation
							
						</li>

						<br>

						<li class="fragment">
							<b class="alert">Foward modeling</b> allows to decouple the morphology from the observing condition
							<ul>
								<!-- <br> -->
								<li> <b class="alert">Deep generative models</b> can be used to provide flexible light profile model</b>.
								</li>
								<!-- <br> -->
								<li> <b class="alert">Explicit likelihood</b>, uses of all of our physical knowledge.<br>
									$\Longrightarrow$ The method can be applied for varying PSF, noise, or even different instruments!
								</li>
	
							</ul>
						</li>

						<br>
						<li class="fragment">
							Joint inference of morpholgy and shear leads to <b class="alert">unbiased</b> marginal shear posterior
						</li>
						<br>

						<li class="fragment">
							Future work
							<ul>
								<!-- <br> -->
								<li> need probabilistic detection in the forward model
								</li>
								<!-- <br> -->
								<li> joint inference of PSF, morophology and cosmic shear (and comsology...)
								</li>
	
							</ul>
						</li>
						
					</ul>
					<div class="fragment">
						<a href="https://arxiv.org/abs/2210.16243"
											><img
												src="https://img.shields.io/badge/astro--ph.CO-arXiv%3A2210.16243-B31B1B.svg"
												class="plain"
												style="height: 35px; vertical-align: middle"
										/></a>
						<br>
					
					</div>
					<br>
					<p class="fragment"> Thank you!</p>
					<br>
					<br>
				
			</section>
		</section>
		</div>
	</div>

	<style>
		/* .reveal .slides {
			border: 5px solid red;
			min-height: 100%;
			width: 128mm;
			height: 96mm;
		} */

		.reveal .block {
			background-color: #191919;
			margin-left: 20px;
			margin-right: 20px;
			text-align: left;
			padding-bottom: 0.1em;
		}

		.reveal .block-title {
			background-color: #333333;
			padding: 8px 35px 8px 14px;
			color: #FFAA7F;
			font-weight: bold;
		}

		.reveal .block-content {
			padding: 8px 35px 8px 14px;
		}

		.reveal .slide-title {
			border-left: 5px solid white;
			text-align: left;
			margin-left: 20px;
			padding-left: 20px;
		}

		.reveal .alert {
			color: #FFAA7F;
			font-weight: bold;
		}

		.reveal .inverted {
			filter: invert(100%);
		}

		/*
	/* .reveal .alert {
	padding:8px 35px 8px 14px; margin-bottom:18px;
	text-shadow:0 1px 0 rgba(255,255,255,1);
	border:5px solid #FFAA7F;
	-webkit-border-radius: 14px; -moz-border-radius: 14px;
	border-radius:14px
	background-position: 10px 10px;
	background-repeat: no-repeat;
	background-size: 38px;
	padding-left: 30px; /* 55px; if icon
	}
	.reveal .alert-block {padding-top:14px; padding-bottom:14px}
	.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
	/*.reveal .alert li {margin-top: 1em}
	.reveal .alert-block p+p {margin-top:5px} */
	</style>


	<script src="reveal.js/dist/reveal.js"></script>
	<script src="reveal.js/plugin/notes/notes.js"></script>
	<script src="reveal.js/plugin/markdown/markdown.js"></script>
	<script src="reveal.js/plugin/highlight/highlight.js"></script>
	<script src="reveal.js/plugin/math/math.js"></script>
	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			controls: false,

			//center: false,
			hash: true,

			// Visibility rule for backwards navigation arrows; "faded", "hidden"
			// or "visible"
			controlsBackArrows: 'hidden',

			// Display a presentation progress bar
			progress: true,

			// Display the page number of the current slide
			slideNumber: true,

			transition: 'slide', // none/fade/slide/convex/concave/zoom

			// The "normal" size of the presentation, aspect ratio will be preserved
			// when the presentation is scaled to fit different resolutions. Can be
			// specified using percentage units.
			width: 1280,
			height: 720,

			// Factor of the display size that should remain empty around the content
			margin: 0.1,

			// Bounds for smallest/largest possible scale to apply to content
			minScale: 0.2,
			maxScale: 1.5,


			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],

			dependencies: [{
					src: 'reveal.js/plugin/markdown/marked.js'
				},
				{
					src: 'reveal.js/plugin/markdown/markdown.js'
				},
				{
					src: 'reveal.js/plugin/notes/notes.js',
					async: true
				},
				{
					src: 'reveal.js/plugin/math/math.js',
					async: true
				},
				{
					src: 'reveal.js/plugin/reveal.js-d3/reveald3.js'
				},
				{
					src: 'reveal.js/plugin/reveal.js-plugins/chart/Chart.min.js'
				},
				{
					src: 'reveal.js/plugin/reveal.js-plugins/chart/csv2chart.js'
				},
				{
					src: 'reveal.js/plugin/highlight/highlight.js',
					async: true
				},
			]

		});
	</script>
</body>

</html>
